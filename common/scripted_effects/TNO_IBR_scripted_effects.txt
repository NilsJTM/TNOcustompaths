IBR_stability_increase = {
	if = {
		limit = { has_idea = IBR_State_Weak }
		swap_ideas = {
			remove_idea = IBR_State_Weak
			add_idea = IBR_State_MedWeak
		}
	}
	else_if = {
		limit = { has_idea = IBR_State_MedWeak }
		swap_ideas = {
			remove_idea = IBR_State_MedWeak
			add_idea = IBR_State_Med
		}
	}
	else_if = {
		limit = { has_idea = IBR_State_Med }
		swap_ideas = {
			remove_idea = IBR_State_Med
			add_idea = IBR_State_MedStrong
		}
	}
	else_if = {
		limit = { has_idea = IBR_State_MedStrong }
		swap_ideas = {
			remove_idea = IBR_State_MedStrong
			add_idea = IBR_State_Strong
		}
	}
	else_if = {
		limit = { has_idea = IBR_State_Strong }
		swap_ideas = {
			remove_idea = IBR_State_Strong
			add_idea = IBR_State_Exemplary
		}
	}
}

IBR_stability_decrease = {
	if = {
		limit = { has_idea = IBR_State_Exemplary }
		swap_ideas = {
			remove_idea = IBR_State_Exemplary
			add_idea = IBR_State_Strong
		}
	}
	else_if = {
		limit = { has_idea = IBR_State_Strong }
		swap_ideas = {
			remove_idea = IBR_State_Strong
			add_idea = IBR_State_MedStrong
		}
	}
	else_if = {
		limit = { has_idea = IBR_State_MedStrong }
		swap_ideas = {
			remove_idea = IBR_State_MedStrong
			add_idea = IBR_State_Med
		}
	}
	else_if = {
		limit = { has_idea = IBR_State_Med }
		swap_ideas = {
			remove_idea = IBR_State_Med
			add_idea = IBR_State_MedWeak
		}
	}
	else_if = {
		limit = { has_idea = IBR_State_MedWeak }
		swap_ideas = {
			remove_idea = IBR_State_MedWeak
			add_idea = IBR_State_Weak
		}
	}
}

IBR_stability_update = {
	if = {
		limit = { 
			check_variable = {
				var = IBRIberiaStability
				value = 5
				compare = less_than
			} 
		}
		hidden_effect = {
		swap_ideas = {
			remove_idea = IBR_State_Exemplary
			add_idea = IBR_State_Weak
		}
			swap_ideas = {
			remove_idea = IBR_State_Strong
			add_idea = IBR_State_Weak
		}
			swap_ideas = {
			remove_idea = IBR_State_MedStrong
			add_idea = IBR_State_Weak
		}
			swap_ideas = {
			remove_idea = IBR_State_Med
			add_idea = IBR_State_Weak
		}
			swap_ideas = {
			remove_idea = IBR_State_MedWeak
			add_idea = IBR_State_Weak
		}
		}
	}
	else_if = {
		limit = { 
			AND = { 
				check_variable = {
					var = IBRIberiaStability
					value = 5
					compare = greater_than_or_equals
				} 
				check_variable = {
					var = IBRIberiaStability
					value = 9
					compare = less_than
				}
			}
		}
		hidden_effect = {
		swap_ideas = {
			remove_idea = IBR_State_Exemplary
			add_idea = IBR_State_MedWeak
		}
			swap_ideas = {
			remove_idea = IBR_State_Strong
			add_idea = IBR_State_MedWeak
		}
			swap_ideas = {
			remove_idea = IBR_State_MedStrong
			add_idea = IBR_State_MedWeak
		}
			swap_ideas = {
			remove_idea = IBR_State_Med
			add_idea = IBR_State_MedWeak
		}
			swap_ideas = {
			remove_idea = IBR_State_Weak
			add_idea = IBR_State_MedWeak
		}
		}
	}
	else_if = {
		limit = { 
			AND = { 
				check_variable = {
					var = IBRIberiaStability
					value = 9
					compare = greater_than_or_equals
				} 
				check_variable = {
					var = IBRIberiaStability
					value = 13
					compare = less_than
				}
			}
		}
		hidden_effect = {
		swap_ideas = {
			remove_idea = IBR_State_Exemplary
			add_idea = IBR_State_Med
		}
			swap_ideas = {
			remove_idea = IBR_State_Strong
			add_idea = IBR_State_Med
		}
			swap_ideas = {
			remove_idea = IBR_State_MedStrong
			add_idea = IBR_State_Med
		}
			swap_ideas = {
			remove_idea = IBR_State_MedWeak
			add_idea = IBR_State_Med
		}
			swap_ideas = {
			remove_idea = IBR_State_Weak
			add_idea = IBR_State_Med
		}
		}
	}
	else_if = {
		limit = { 
			AND = { 
				check_variable = {
					var = IBRIberiaStability
					value = 13
					compare = greater_than_or_equals
				} 
				check_variable = {
					var = IBRIberiaStability
					value = 17
					compare = less_than
				}
			}
		}
		hidden_effect = {
		swap_ideas = {
			remove_idea = IBR_State_Exemplary
			add_idea = IBR_State_MedStrong
		}
			swap_ideas = {
			remove_idea = IBR_State_Strong
			add_idea = IBR_State_MedStrong
		}
			swap_ideas = {
			remove_idea = IBR_State_Med
			add_idea = IBR_State_MedStrong
		}
			swap_ideas = {
			remove_idea = IBR_State_MedWeak
			add_idea = IBR_State_MedStrong
		}
			swap_ideas = {
			remove_idea = IBR_State_Weak
			add_idea = IBR_State_MedStrong
		}
		}
	}
	else_if = {
		limit = { 
			AND = { 
				check_variable = {
					var = IBRIberiaStability
					value = 17
					compare = greater_than_or_equals
				} 
				check_variable = {
					var = IBRIberiaStability
					value = 21
					compare = less_than
				}
			}
		}
		hidden_effect = {
		swap_ideas = {
			remove_idea = IBR_State_Exemplary
			add_idea = IBR_State_Strong
		}
			swap_ideas = {
			remove_idea = IBR_State_MedStrong
			add_idea = IBR_State_Strong
		}
			swap_ideas = {
			remove_idea = IBR_State_Med
			add_idea = IBR_State_Strong
		}
			swap_ideas = {
			remove_idea = IBR_State_MedWeak
			add_idea = IBR_State_Strong
		}
			swap_ideas = {
			remove_idea = IBR_State_Weak
			add_idea = IBR_State_Strong
		}
		}
	}
	else_if = {
		limit = { 
			check_variable = {
				var = IBRIberiaStability
				value = 21
				compare = greater_than_or_equals
			} 
		}
		hidden_effect = {
		swap_ideas = {
			remove_idea = IBR_State_Strong
			add_idea = IBR_State_Exemplary
		}
		swap_ideas = {
			remove_idea = IBR_State_MedStrong
			add_idea = IBR_State_Exemplary
		}
		swap_ideas = {
			remove_idea = IBR_State_Med
			add_idea = IBR_State_Exemplary
		}
		swap_ideas = {
			remove_idea = IBR_State_MedWeak
			add_idea = IBR_State_Exemplary
		}
		swap_ideas = {
			remove_idea = IBR_State_Weak
			add_idea = IBR_State_Exemplary
		}
		}
	}
}

IBR_terror_vunerable_check = {

    if = {
	    limit = {
		    NOT = {
				has_country_flag = IBRCNTBroken
			}
			check_variable = {
				IBR_CNT_Activity < 0.01
			}
			check_variable = {
				IBR_CNT_Resources < 0.01
			}
			check_variable = {
				IBR_CNT_Support < 0.01
			}
		}
		set_country_flag = IBR_CNT_vulnerable
		
		custom_effect_tooltip = IBR_CNT_vulnerable_tt
    }
	if = {
	    limit = {
			has_country_flag = IBR_CNT_vulnerable
			NOT = {
				has_country_flag = IBRCNTBroken
			}
			OR = {
			check_variable = {
				IBR_CNT_Activity > 0
			}
			check_variable = {
				IBR_CNT_Resources > 0
			}
			check_variable = {
				IBR_CNT_Support > 0
			}
			}
		}
		clr_country_flag = IBR_CNT_vulnerable
    }
	if = {
	    limit = {
		    NOT = {
				has_country_flag = IBRETABroken
			}
			check_variable = {
				IBR_ETA_Activity < 0.01
			}
			check_variable = {
				IBR_ETA_Resources < 0.01
			}
			check_variable = {
				IBR_ETA_Support < 0.01
			}
		}
		set_country_flag = IBR_ETA_vulnerable
		
		custom_effect_tooltip = IBR_ETA_vulnerable_tt
    }
	if = {
	    limit = {
			has_country_flag = IBR_ETA_vulnerable
			NOT = {
				has_country_flag = IBRETABroken
			}
			OR = {
			check_variable = {
				IBR_ETA_Activity > 0
			}
			check_variable = {
				IBR_ETA_Resources > 0
			}
			check_variable = {
				IBR_ETA_Support > 0
			}
			}
		}
		clr_country_flag = IBR_ETA_vulnerable
    }
	if = {
	    limit = {
		    NOT = {
				has_country_flag = IBRFSLPBroken
			}
			check_variable = {
				IBR_FSLP_Activity < 0.01
			}
			check_variable = {
				IBR_FSLP_Resources < 0.01
			}
			check_variable = {
				IBR_FSLP_Support < 0.01
			}
		}
		set_country_flag = IBR_FSLP_vulnerable
		
		custom_effect_tooltip = IBR_FSLP_vulnerable_tt
    }
	if = {
	    limit = {
			has_country_flag = IBR_FSLP_vulnerable
			NOT = {
				has_country_flag = IBRFSLPBroken
			}
			OR = {
			check_variable = {
				IBR_FSLP_Activity > 0
			}
			check_variable = {
				IBR_FSLP_Resources > 0
			}
			check_variable = {
				IBR_FSLP_Support > 0
			}
			}
		}
		clr_country_flag = IBR_FSLP_vulnerable
    }
	if = {
	    limit = {
		    NOT = {
				has_country_flag = IBRTBABroken
			}
			check_variable = {
				IBR_TBA_Activity < 0.01
			}
			check_variable = {
				IBR_TBA_Resources < 0.01
			}
			check_variable = {
				IBR_TBA_Support < 0.01
			}
		}
		set_country_flag = IBR_TBA_vulnerable
		
		custom_effect_tooltip = IBR_TBA_vulnerable_tt
    }
	if = {
	    limit = {
			has_country_flag = IBR_TBA_vulnerable
			NOT = {
				has_country_flag = IBRTBABroken
			}
			OR = {
			check_variable = {
				IBR_TBA_Activity > 0
			}
			check_variable = {
				IBR_TBA_Resources > 0
			}
			check_variable = {
				IBR_TBA_Support > 0
			}
			}
		}
		clr_country_flag = IBR_TBA_vulnerable
    }
	
	####THE MONSTROSITY OF FINDING HOW MUCH IT COSTS TO BUY DOWN A TERROR GROUP ENTIRELY
	
	##Cost to buy down CNT
	
	#Temp variable, CNT activity
	
	if = {
		limit = { check_variable = { IBR_CNT_Activity < 0 } }

		set_temp_variable = { IBR_CNT_activity_BUYDOWN_round = 0 }
	}
	else_if = {
		limit = { check_variable = { IBR_CNT_Activity < 2.1 } }
		
		set_temp_variable = { IBR_CNT_activity_BUYDOWN = IBR_CNT_Activity }
		divide_temp_variable = { IBR_CNT_activity_BUYDOWN = 0.4 }
		
		#ROUND UP
		
		set_temp_variable = { IBR_CNT_activity_BUYDOWN_round = IBR_CNT_activity_BUYDOWN }
		
		round_temp_variable = IBR_CNT_activity_BUYDOWN_round
		
		if = {
			limit = { check_variable = { IBR_CNT_activity_BUYDOWN_round < IBR_CNT_activity_BUYDOWN } }
			
			add_to_temp_variable = { IBR_CNT_activity_BUYDOWN_round = 1 }
		}
	}
	else = {
		set_temp_variable = { IBR_CNT_activity_BUYDOWN = IBR_CNT_Activity }
		
		subtract_from_temp_variable = { IBR_CNT_activity_BUYDOWN = 2 } 
		
		add_to_temp_variable = { IBR_CNT_activity_BUYDOWN = 5 }
		
		#ROUND UP
		
		set_temp_variable = { IBR_CNT_activity_BUYDOWN_round = IBR_CNT_activity_BUYDOWN }
		
		round_temp_variable = IBR_CNT_activity_BUYDOWN_round
		
		if = {
			limit = { check_variable = { IBR_CNT_activity_BUYDOWN_round < IBR_CNT_activity_BUYDOWN } }
			
			add_to_temp_variable = { IBR_CNT_activity_BUYDOWN_round = 1 }
		}
	}
	#Temp variable, CNT supplies 
	
	if = {
		limit = { check_variable = { IBR_CNT_Resources < 0 } }

		set_temp_variable = { IBR_CNT_supplies_BUYDOWN_round = 0 }
	}
	else_if = {
		limit = { check_variable = { IBR_CNT_Resources < 2.1 } }
		
		set_temp_variable = { IBR_CNT_supplies_BUYDOWN = IBR_CNT_Resources }
		divide_temp_variable = { IBR_CNT_supplies_BUYDOWN = 0.4 }
		
		#ROUND UP
		
		set_temp_variable = { IBR_CNT_supplies_BUYDOWN_round = IBR_CNT_supplies_BUYDOWN }
		
		round_temp_variable = IBR_CNT_supplies_BUYDOWN_round
		
		if = {
			limit = { check_variable = { IBR_CNT_supplies_BUYDOWN_round < IBR_CNT_supplies_BUYDOWN } }
			
			add_to_temp_variable = { IBR_CNT_supplies_BUYDOWN_round = 1 }
		}

		multiply_temp_variable = { IBR_CNT_supplies_BUYDOWN_round = 2 }
	}
	else = {
		set_temp_variable = { IBR_CNT_supplies_BUYDOWN = IBR_CNT_Resources }
		
		subtract_from_temp_variable = { IBR_CNT_supplies_BUYDOWN = 2 } 
		
		add_to_temp_variable = { IBR_CNT_supplies_BUYDOWN = 5 }
		
		#ROUND UP
		
		set_temp_variable = { IBR_CNT_supplies_BUYDOWN_round = IBR_CNT_supplies_BUYDOWN }
		
		round_temp_variable = IBR_CNT_supplies_BUYDOWN_round
		
		if = {
			limit = { check_variable = { IBR_CNT_supplies_BUYDOWN_round < IBR_CNT_supplies_BUYDOWN } }
			
			add_to_temp_variable = { IBR_CNT_supplies_BUYDOWN_round = 1 }
		}

		multiply_temp_variable = { IBR_CNT_supplies_BUYDOWN_round = 2 }
	}
	
	#Temp variable, CNT support
	
	if = {
		limit = { check_variable = { IBR_CNT_Support < 0 } }

		set_temp_variable = { IBR_CNT_support_BUYDOWN_round = 0 }
	}
	else_if = {
		limit = { check_variable = { IBR_CNT_Support < 2.1 } }
		
		set_temp_variable = { IBR_CNT_support_BUYDOWN = IBR_CNT_Support }
		divide_temp_variable = { IBR_CNT_support_BUYDOWN = 0.16 }
		
		#ROUND UP
		
		set_temp_variable = { IBR_CNT_support_BUYDOWN_round = IBR_CNT_support_BUYDOWN }
		
		round_temp_variable = IBR_CNT_support_BUYDOWN_round
		
		if = {
			limit = { check_variable = { IBR_CNT_support_BUYDOWN_round < IBR_CNT_support_BUYDOWN } }
			
			add_to_temp_variable = { IBR_CNT_support_BUYDOWN_round = 1 }
		}
	}
	else = {
		set_temp_variable = { IBR_CNT_support_BUYDOWN = IBR_CNT_Support }
		
		subtract_from_temp_variable = { IBR_CNT_support_BUYDOWN = 2 } 
		
		add_to_temp_variable = { IBR_CNT_support_BUYDOWN = 13 }
		
		#ROUND UP
		
		set_temp_variable = { IBR_CNT_support_BUYDOWN_round = IBR_CNT_support_BUYDOWN }
		
		round_temp_variable = IBR_CNT_support_BUYDOWN_round
		
		if = {
			limit = { check_variable = { IBR_CNT_support_BUYDOWN_round < IBR_CNT_support_BUYDOWN } }
			
			add_to_temp_variable = { IBR_CNT_support_BUYDOWN_round = 1 }
		}
	}
	
	set_variable = { IBR_CNT_BUYDOWN = 5 } #ADDED 5 FOR TIME BEING, MAYBE CHANGE THIS LATER IF ITS WEIRD
	add_to_variable = { IBR_CNT_BUYDOWN = IBR_CNT_activity_BUYDOWN_round }
	add_to_variable = { IBR_CNT_BUYDOWN = IBR_CNT_supplies_BUYDOWN_round }
	add_to_variable = { IBR_CNT_BUYDOWN = IBR_CNT_support_BUYDOWN_round }
	
	##Cost to buy down FSLP
	
	#Temp variable, FSLP activity
	
	if = {
		limit = { check_variable = { IBR_FSLP_Activity < 0 } }

		set_temp_variable = { IBR_FSLP_activity_BUYDOWN_round = 0 }
	}
	else_if = {
		limit = { check_variable = { IBR_FSLP_Activity < 2.1 } }
		
		set_temp_variable = { IBR_FSLP_activity_BUYDOWN = IBR_FSLP_Activity }
		divide_temp_variable = { IBR_FSLP_activity_BUYDOWN = 0.4 }
		
		#ROUND UP
		
		set_temp_variable = { IBR_FSLP_activity_BUYDOWN_round = IBR_FSLP_activity_BUYDOWN }
		
		round_temp_variable = IBR_FSLP_activity_BUYDOWN_round
		
		if = {
			limit = { check_variable = { IBR_FSLP_activity_BUYDOWN_round < IBR_FSLP_activity_BUYDOWN } }
			
			add_to_temp_variable = { IBR_FSLP_activity_BUYDOWN_round = 1 }
		}
	}
	else = {
		set_temp_variable = { IBR_FSLP_activity_BUYDOWN = IBR_FSLP_Activity }
		
		subtract_from_temp_variable = { IBR_FSLP_activity_BUYDOWN = 2 } 
		
		add_to_temp_variable = { IBR_FSLP_activity_BUYDOWN = 5 }
		
		#ROUND UP
		
		set_temp_variable = { IBR_FSLP_activity_BUYDOWN_round = IBR_FSLP_activity_BUYDOWN }
		
		round_temp_variable = IBR_FSLP_activity_BUYDOWN_round
	}
	#Temp variable, FSLP supplies 
	
	if = {
		limit = { check_variable = { IBR_FSLP_Resources < 0 } }

		set_temp_variable = { IBR_FSLP_supplies_BUYDOWN_round = 0 }
	}
	else_if = {
		limit = { check_variable = { IBR_FSLP_Resources < 2.1 } }
		
		set_temp_variable = { IBR_FSLP_supplies_BUYDOWN = IBR_FSLP_Resources }
		divide_temp_variable = { IBR_FSLP_supplies_BUYDOWN = 0.4 }
		
		#ROUND UP
		
		set_temp_variable = { IBR_FSLP_supplies_BUYDOWN_round = IBR_FSLP_supplies_BUYDOWN }
		
		round_temp_variable = IBR_FSLP_supplies_BUYDOWN_round
		
		if = {
			limit = { check_variable = { IBR_FSLP_supplies_BUYDOWN_round < IBR_FSLP_supplies_BUYDOWN } }
			
			add_to_temp_variable = { IBR_FSLP_supplies_BUYDOWN_round = 1 }
		}

		multiply_temp_variable = { IBR_FSLP_supplies_BUYDOWN_round = 2 }
	}
	else = {
		set_temp_variable = { IBR_FSLP_supplies_BUYDOWN = IBR_FSLP_Resources }
		
		subtract_from_temp_variable = { IBR_FSLP_supplies_BUYDOWN = 2 } 
		
		add_to_temp_variable = { IBR_FSLP_supplies_BUYDOWN = 5 }
		
		#ROUND UP
		
		set_temp_variable = { IBR_FSLP_supplies_BUYDOWN_round = IBR_FSLP_supplies_BUYDOWN }
		
		round_temp_variable = IBR_FSLP_supplies_BUYDOWN_round
		
		if = {
			limit = { check_variable = { IBR_FSLP_supplies_BUYDOWN_round < IBR_FSLP_supplies_BUYDOWN } }
			
			add_to_temp_variable = { IBR_FSLP_supplies_BUYDOWN_round = 1 }
		}

		multiply_temp_variable = { IBR_FSLP_supplies_BUYDOWN_round = 2 }
	}
	
	#Temp variable, FSLP support
	
	if = {
		limit = { check_variable = { IBR_FSLP_Support < 0 } }

		set_temp_variable = { IBR_FSLP_support_BUYDOWN_round = 0 }
	}
	else_if = {
		limit = { check_variable = { IBR_FSLP_Support < 2.1 } }
		
		set_temp_variable = { IBR_FSLP_support_BUYDOWN = IBR_FSLP_Support }
		divide_temp_variable = { IBR_FSLP_support_BUYDOWN = 0.16 }
		
		#ROUND UP
		
		set_temp_variable = { IBR_FSLP_support_BUYDOWN_round = IBR_FSLP_support_BUYDOWN }
		
		round_temp_variable = IBR_FSLP_support_BUYDOWN_round
		
		if = {
			limit = { check_variable = { IBR_FSLP_support_BUYDOWN_round < IBR_FSLP_support_BUYDOWN } }
			
			add_to_temp_variable = { IBR_FSLP_support_BUYDOWN_round = 1 }
		}
	}
	else = {
		set_temp_variable = { IBR_FSLP_support_BUYDOWN = IBR_FSLP_Support }
		
		subtract_from_temp_variable = { IBR_FSLP_support_BUYDOWN = 2 } 
		
		add_to_temp_variable = { IBR_FSLP_support_BUYDOWN = 13 }
		
		#ROUND UP
		
		set_temp_variable = { IBR_FSLP_support_BUYDOWN_round = IBR_FSLP_support_BUYDOWN }
		
		round_temp_variable = IBR_FSLP_support_BUYDOWN_round
		
		if = {
			limit = { check_variable = { IBR_FSLP_support_BUYDOWN_round < IBR_FSLP_support_BUYDOWN } }
			
			add_to_temp_variable = { IBR_FSLP_support_BUYDOWN_round = 1 }
		}
	}
	
	set_variable = { IBR_FSLP_BUYDOWN = 5 } #ADDED 5 FOR TIME BEING, MAYBE CHANGE THIS LATER IF ITS WEIRD
	add_to_variable = { IBR_FSLP_BUYDOWN = IBR_FSLP_activity_BUYDOWN_round }
	add_to_variable = { IBR_FSLP_BUYDOWN = IBR_FSLP_supplies_BUYDOWN_round }
	add_to_variable = { IBR_FSLP_BUYDOWN = IBR_FSLP_support_BUYDOWN_round }
	
	##Cost to buy down ETA
	
	#Temp variable, ETA activity
	
	if = {
		limit = { check_variable = { IBR_ETA_Activity < 0 } }

		set_temp_variable = { IBR_ETA_activity_BUYDOWN_round = 0 }
	}
	else_if = {
		limit = { check_variable = { IBR_ETA_Activity < 2.1 } }
		
		set_temp_variable = { IBR_ETA_activity_BUYDOWN = IBR_ETA_Activity }
		divide_temp_variable = { IBR_ETA_activity_BUYDOWN = 0.3 }
		
		#ROUND UP
		
		set_temp_variable = { IBR_ETA_activity_BUYDOWN_round = IBR_ETA_activity_BUYDOWN }
		
		round_temp_variable = IBR_ETA_activity_BUYDOWN_round
		
		if = {
			limit = { check_variable = { IBR_ETA_activity_BUYDOWN_round < IBR_ETA_activity_BUYDOWN } }
			
			add_to_temp_variable = { IBR_ETA_activity_BUYDOWN_round = 1 }
		}
	}
	else = {
		set_temp_variable = { IBR_ETA_activity_BUYDOWN = IBR_ETA_Activity }
		
		subtract_from_temp_variable = { IBR_ETA_activity_BUYDOWN = 2 } 
		
		add_to_temp_variable = { IBR_ETA_activity_BUYDOWN = 7 }
		
		#ROUND UP
		
		set_temp_variable = { IBR_ETA_activity_BUYDOWN_round = IBR_ETA_activity_BUYDOWN }
		
		round_temp_variable = IBR_ETA_activity_BUYDOWN_round
		
		if = {
			limit = { check_variable = { IBR_ETA_activity_BUYDOWN_round < IBR_ETA_activity_BUYDOWN } }
			
			add_to_temp_variable = { IBR_ETA_activity_BUYDOWN_round = 1 }
		}
	}
	#Temp variable, ETA supplies 
	
	if = {
		limit = { check_variable = { IBR_ETA_Resources < 0 } }

		set_temp_variable = { IBR_ETA_supplies_BUYDOWN_round = 0 }
	}
	else_if = {
		limit = { check_variable = { IBR_ETA_Resources < 2.1 } }
		
		set_temp_variable = { IBR_ETA_supplies_BUYDOWN = IBR_ETA_Resources }
		divide_temp_variable = { IBR_ETA_supplies_BUYDOWN = 0.3 }
		
		#ROUND UP
		
		set_temp_variable = { IBR_ETA_supplies_BUYDOWN_round = IBR_ETA_supplies_BUYDOWN }
		
		round_temp_variable = IBR_ETA_supplies_BUYDOWN_round
		
		if = {
			limit = { check_variable = { IBR_ETA_supplies_BUYDOWN_round < IBR_ETA_supplies_BUYDOWN } }
			
			add_to_temp_variable = { IBR_ETA_supplies_BUYDOWN_round = 1 }
		}

		multiply_temp_variable = { IBR_ETA_supplies_BUYDOWN_round = 2 }
	}
	else = {
		set_temp_variable = { IBR_ETA_supplies_BUYDOWN = IBR_ETA_Resources }
		
		subtract_from_temp_variable = { IBR_ETA_supplies_BUYDOWN = 2 } 
		
		add_to_temp_variable = { IBR_ETA_supplies_BUYDOWN = 7 }
		
		#ROUND UP
		
		set_temp_variable = { IBR_ETA_supplies_BUYDOWN_round = IBR_ETA_supplies_BUYDOWN }
		
		round_temp_variable = IBR_ETA_supplies_BUYDOWN_round
		
		if = {
			limit = { check_variable = { IBR_ETA_supplies_BUYDOWN_round < IBR_ETA_supplies_BUYDOWN } }
			
			add_to_temp_variable = { IBR_ETA_supplies_BUYDOWN_round = 1 }
		}

		multiply_temp_variable = { IBR_ETA_supplies_BUYDOWN_round = 2 }
	}
	
	#Temp variable, ETA support
	
	if = {
		limit = { check_variable = { IBR_ETA_Support < 0 } }

		set_temp_variable = { IBR_ETA_support_BUYDOWN_round = 0 }
	}
	else_if = {
		limit = { check_variable = { IBR_ETA_Support < 2.1 } }
		
		set_temp_variable = { IBR_ETA_support_BUYDOWN = IBR_ETA_Support }
		divide_temp_variable = { IBR_ETA_support_BUYDOWN = 0.12 }
		
		#ROUND UP
		
		set_temp_variable = { IBR_ETA_support_BUYDOWN_round = IBR_ETA_support_BUYDOWN }
		
		round_temp_variable = IBR_ETA_support_BUYDOWN_round
		
		if = {
			limit = { check_variable = { IBR_ETA_support_BUYDOWN_round < IBR_ETA_support_BUYDOWN } }
			
			add_to_temp_variable = { IBR_ETA_support_BUYDOWN_round = 1 }
		}
	}
	else = {
		set_temp_variable = { IBR_ETA_support_BUYDOWN = IBR_ETA_Support }
		
		subtract_from_temp_variable = { IBR_ETA_support_BUYDOWN = 2 } 
		
		add_to_temp_variable = { IBR_ETA_support_BUYDOWN = 17 }
		
		#ROUND UP
		
		set_temp_variable = { IBR_ETA_support_BUYDOWN_round = IBR_ETA_support_BUYDOWN }
		
		round_temp_variable = IBR_ETA_support_BUYDOWN_round
		
		if = {
			limit = { check_variable = { IBR_ETA_support_BUYDOWN_round < IBR_ETA_support_BUYDOWN } }
			
			add_to_temp_variable = { IBR_ETA_support_BUYDOWN_round = 1 }
		}
	}
	
	set_variable = { IBR_ETA_BUYDOWN = 5 } #ADDED 5 FOR TIME BEING, MAYBE CHANGE THIS LATER IF ITS WEIRD
	add_to_variable = { IBR_ETA_BUYDOWN = IBR_ETA_activity_BUYDOWN_round }
	add_to_variable = { IBR_ETA_BUYDOWN = IBR_ETA_supplies_BUYDOWN_round }
	add_to_variable = { IBR_ETA_BUYDOWN = IBR_ETA_support_BUYDOWN_round }
	
	##Cost to buy down BTA (TBA)
	
	#Temp variable, TBA activity
	
	if = {
		limit = { check_variable = { IBR_TBA_Activity < 0 } }

		set_temp_variable = { IBR_TBA_activity_BUYDOWN_round = 0 }
	}
	else_if = {
		limit = { check_variable = { IBR_TBA_Activity < 2.1 } }
		
		set_temp_variable = { IBR_TBA_activity_BUYDOWN = IBR_TBA_Activity }
		divide_temp_variable = { IBR_TBA_activity_BUYDOWN = 0.5 }
		
		#ROUND UP
		
		set_temp_variable = { IBR_TBA_activity_BUYDOWN_round = IBR_TBA_activity_BUYDOWN }
		
		round_temp_variable = IBR_TBA_activity_BUYDOWN_round
		
		if = {
			limit = { check_variable = { IBR_TBA_activity_BUYDOWN_round < IBR_TBA_activity_BUYDOWN } }
			
			add_to_temp_variable = { IBR_TBA_activity_BUYDOWN_round = 1 }
		}
	}
	else = {
		set_temp_variable = { IBR_TBA_activity_BUYDOWN = IBR_TBA_Activity }
		
		subtract_from_temp_variable = { IBR_TBA_activity_BUYDOWN = 2 } 
		
		add_to_temp_variable = { IBR_TBA_activity_BUYDOWN = 4 }
		
		#ROUND UP
		
		set_temp_variable = { IBR_TBA_activity_BUYDOWN_round = IBR_TBA_activity_BUYDOWN }
		
		round_temp_variable = IBR_TBA_activity_BUYDOWN_round
		
		if = {
			limit = { check_variable = { IBR_TBA_activity_BUYDOWN_round < IBR_TBA_activity_BUYDOWN } }
			
			add_to_temp_variable = { IBR_TBA_activity_BUYDOWN_round = 1 }
		}
	}
	#Temp variable, TBA supplies 
	
	if = {
		limit = { check_variable = { IBR_TBA_Resources < 0 } }

		set_temp_variable = { IBR_TBA_supplies_BUYDOWN_round = 0 }
	}
	else_if = {
		limit = { check_variable = { IBR_TBA_Resources < 2.1 } }
		
		set_temp_variable = { IBR_TBA_supplies_BUYDOWN = IBR_TBA_Resources }

		divide_temp_variable = { IBR_TBA_supplies_BUYDOWN = 0.5 }
		
		#ROUND UP
		
		set_temp_variable = { IBR_TBA_supplies_BUYDOWN_round = IBR_TBA_supplies_BUYDOWN }
		
		round_temp_variable = IBR_TBA_supplies_BUYDOWN_round
		
		if = {
			limit = { check_variable = { IBR_TBA_supplies_BUYDOWN_round < IBR_TBA_supplies_BUYDOWN } }
			
			add_to_temp_variable = { IBR_TBA_supplies_BUYDOWN_round = 1 }
		}

		multiply_temp_variable = { IBR_TBA_supplies_BUYDOWN_round = 2 }
	}
	else = {
		set_temp_variable = { IBR_TBA_supplies_BUYDOWN = IBR_TBA_Resources }
		
		subtract_from_temp_variable = { IBR_TBA_supplies_BUYDOWN = 2 } 
		
		add_to_temp_variable = { IBR_TBA_supplies_BUYDOWN = 4 }
		
		#ROUND UP
		
		set_temp_variable = { IBR_TBA_supplies_BUYDOWN_round = IBR_TBA_supplies_BUYDOWN }
		
		round_temp_variable = IBR_TBA_supplies_BUYDOWN_round
		
		if = {
			limit = { check_variable = { IBR_TBA_supplies_BUYDOWN_round < IBR_TBA_supplies_BUYDOWN } }
			
			add_to_temp_variable = { IBR_TBA_supplies_BUYDOWN_round = 1 }
		}

		multiply_temp_variable = { IBR_TBA_supplies_BUYDOWN_round = 2 }
	}
	
	#Temp variable, TBA support
	
	if = {
		limit = { check_variable = { IBR_TBA_Support < 0 } }

		set_temp_variable = { IBR_TBA_support_BUYDOWN_round = 0 }
	}
	else_if = {
		limit = { check_variable = { IBR_TBA_Support < 2.1 } }
		
		set_temp_variable = { IBR_TBA_support_BUYDOWN = IBR_TBA_Support }
		divide_temp_variable = { IBR_TBA_support_BUYDOWN = 0.2 }
		
		#ROUND UP
		
		set_temp_variable = { IBR_TBA_support_BUYDOWN_round = IBR_TBA_support_BUYDOWN }
		
		round_temp_variable = IBR_TBA_support_BUYDOWN_round
		
		if = {
			limit = { check_variable = { IBR_TBA_support_BUYDOWN_round < IBR_TBA_support_BUYDOWN } }
			
			add_to_temp_variable = { IBR_TBA_support_BUYDOWN_round = 1 }
		}
	}
	else = {
		set_temp_variable = { IBR_TBA_support_BUYDOWN = IBR_TBA_Support }
		
		subtract_from_temp_variable = { IBR_TBA_support_BUYDOWN = 2 } 
		
		add_to_temp_variable = { IBR_TBA_support_BUYDOWN = 10 }
		
		#ROUND UP
		
		set_temp_variable = { IBR_TBA_support_BUYDOWN_round = IBR_TBA_support_BUYDOWN }
		
		round_temp_variable = IBR_TBA_support_BUYDOWN_round
		
		if = {
			limit = { check_variable = { IBR_TBA_support_BUYDOWN_round < IBR_TBA_support_BUYDOWN } }
			
			add_to_temp_variable = { IBR_TBA_support_BUYDOWN_round = 1 }
		}
	}
	
	set_variable = { IBR_TBA_BUYDOWN = 5 } #ADDED 5 FOR TIME BEING, MAYBE CHANGE THIS LATER IF ITS WEIRD
	add_to_variable = { IBR_TBA_BUYDOWN = IBR_TBA_activity_BUYDOWN_round }
	add_to_variable = { IBR_TBA_BUYDOWN = IBR_TBA_supplies_BUYDOWN_round }
	add_to_variable = { IBR_TBA_BUYDOWN = IBR_TBA_support_BUYDOWN_round }
}

IBR_CNT_ticker = {
	set_variable = { IBR_CNT_support_gain = 0.15 }
	set_temp_variable = { IBR_CNT_support_gain_mult = IBR_CNT_Support }
	multiply_temp_variable = { IBR_CNT_support_gain_mult = 0.33 }
	if = {
		limit = {
			NOT = {
				check_variable = { IBR_CNT_support_gain_mult < 1 }
			}
		}
		multiply_variable = { IBR_CNT_support_gain = IBR_CNT_support_gain_mult }
	}
	
	if = {
		limit = {
			has_government = authoritarian_democrat
		}
		multiply_variable = { IBR_CNT_support_gain = 0.7 }
	}
	if = {
		limit = {
			has_government = social_conservative
		}
		multiply_variable = { IBR_CNT_support_gain = 0.4 }
	}
	else_if = {
		limit = {
			has_government = market_liberal
		}
		multiply_variable = { IBR_CNT_support_gain = 0.1 }
	}
	if = {
		limit = {
			has_government = social_liberal
		}
		multiply_variable = { IBR_CNT_support_gain = -0.1 }
	}
	else_if = {
		limit = {
			has_government = social_democrat
		}
		multiply_variable = { IBR_CNT_support_gain = -0.4 }
	}
	add_to_variable = { IBR_CNT_Support = IBR_CNT_support_gain }

	###For each separatist group - activity gain

	set_variable = { IBR_CNT_activity_gain = 0.075 }
	set_temp_variable = { IBR_CNT_activity_gain_add = IBR_CNT_Support }
	multiply_temp_variable = { IBR_CNT_activity_gain_add = 0.125 }
	add_to_variable = { IBR_CNT_activity_gain = IBR_CNT_activity_gain_add }
	
	if = {
		limit = {
			has_government = authoritarian_democrat
		}
		multiply_variable = { IBR_CNT_activity_gain = 0.7 }
	}
	if = {
		limit = {
			has_government = social_conservative
		}
		multiply_variable = { IBR_CNT_activity_gain = 0.4 }
	}
	else_if = {
		limit = {
			has_government = market_liberal
		}
		multiply_variable = { IBR_CNT_activity_gain = 0.1 }
	}
	if = {
		limit = {
			has_government = social_liberal
		}
		multiply_variable = { IBR_CNT_activity_gain = -0.1 }
	}
	else_if = {
		limit = {
			has_government = social_democrat
		}
		multiply_variable = { IBR_CNT_activity_gain = -0.4 }
	}
	add_to_variable = { IBR_CNT_Activity = IBR_CNT_activity_gain }

	###For each separatist group - supply gain

	set_variable = { IBR_CNT_resources_gain = 0.075 }
	set_temp_variable = { IBR_CNT_resources_gain_add = IBR_CNT_Support }
	multiply_temp_variable = { IBR_CNT_resources_gain_add = 0.125 }
	add_to_variable = { IBR_CNT_resources_gain = IBR_CNT_resources_gain_add } 
	
	if = {
		limit = {
			has_government = authoritarian_democrat
		}
		multiply_variable = { IBR_CNT_resources_gain = 0.7 }
	}
	if = {
		limit = {
			has_government = social_conservative
		}
		multiply_variable = { IBR_CNT_resources_gain = 0.4 }
	}
	else_if = {
		limit = {
			has_government = market_liberal
		}
		multiply_variable = { IBR_CNT_resources_gain = 0.1 }
	}
	if = {
		limit = {
			has_government = social_liberal
		}
		multiply_variable = { IBR_CNT_resources_gain = -0.1 }
	}
	else_if = {
		limit = {
			has_government = social_democrat
		}
		multiply_variable = { IBR_CNT_resources_gain = -0.4 }
	}
	add_to_variable = { IBR_CNT_Resources = IBR_CNT_resources_gain }
	
	clamp_variable = {
		var = IBR_CNT_Activity
		min = -1
		max = 10
	}
	clamp_variable = {
		var = IBR_CNT_Resources
		min = -1
		max = 10
	}
	clamp_variable = {
		var = IBR_CNT_Support
		min = -1
		max = 10
	}
}
IBR_TBA_ticker = {
	###For each separatist group - support gain

	set_variable = { IBR_TBA_support_gain = 0.15 }
	set_temp_variable = { IBR_TBA_support_gain_mult = IBR_TBA_Support }
	multiply_temp_variable = { IBR_TBA_support_gain_mult = 0.33 }
	if = {
		limit = {
			NOT = {
				check_variable = { IBR_TBA_support_gain_mult < 1 }
			}
		}
		multiply_variable = { IBR_TBA_support_gain = IBR_TBA_support_gain_mult }
	}
	
	if = {
		limit = {
			has_government = authoritarian_democrat
		}
		multiply_variable = { IBR_TBA_support_gain = 0.7 }
	}
	if = {
		limit = {
			has_government = social_conservative
		}
		multiply_variable = { IBR_TBA_support_gain = 0.4 }
	}
	else_if = {
		limit = {
			has_government = market_liberal
		}
		multiply_variable = { IBR_TBA_support_gain = 0.1 }
	}
	if = {
		limit = {
			has_government = social_liberal
		}
		multiply_variable = { IBR_TBA_support_gain = -0.1 }
	}
	else_if = {
		limit = {
			has_government = social_democrat
		}
		multiply_variable = { IBR_TBA_support_gain = -0.4 }
	}
	add_to_variable = { IBR_TBA_Support = IBR_TBA_support_gain }

	###For each separatist group - activity gain

	set_variable = { IBR_TBA_activity_gain = 0.075 }
	set_temp_variable = { IBR_TBA_activity_gain_add = IBR_TBA_Support }
	multiply_temp_variable = { IBR_TBA_activity_gain_add = 0.125 }
	add_to_variable = { IBR_TBA_activity_gain = IBR_TBA_activity_gain_add }
	
	if = {
		limit = {
			has_government = authoritarian_democrat
		}
		multiply_variable = { IBR_TBA_activity_gain = 0.7 }
	}
	if = {
		limit = {
			has_government = social_conservative
		}
		multiply_variable = { IBR_TBA_activity_gain = 0.4 }
	}
	else_if = {
		limit = {
			has_government = market_liberal
		}
		multiply_variable = { IBR_TBA_activity_gain = 0.1 }
	}
	if = {
		limit = {
			has_government = social_liberal
		}
		multiply_variable = { IBR_TBA_activity_gain = -0.1 }
	}
	else_if = {
		limit = {
			has_government = social_democrat
		}
		multiply_variable = { IBR_TBA_activity_gain = -0.4 }
	}
	add_to_variable = { IBR_TBA_Activity = IBR_TBA_activity_gain }

	###For each separatist group - supply gain

	set_variable = { IBR_TBA_resources_gain = 0.075 }
	set_temp_variable = { IBR_TBA_resources_gain_add = IBR_TBA_Support }
	multiply_temp_variable = { IBR_TBA_resources_gain_add = 0.125 }
	add_to_variable = { IBR_TBA_resources_gain = IBR_TBA_resources_gain_add } 
	
	if = {
		limit = {
			has_government = authoritarian_democrat
		}
		multiply_variable = { IBR_TBA_resources_gain = 0.7 }
	}
	if = {
		limit = {
			has_government = social_conservative
		}
		multiply_variable = { IBR_TBA_resources_gain = 0.4 }
	}
	else_if = {
		limit = {
			has_government = market_liberal
		}
		multiply_variable = { IBR_TBA_resources_gain = 0.1 }
	}
	if = {
		limit = {
			has_government = social_liberal
		}
		multiply_variable = { IBR_TBA_resources_gain = -0.1 }
	}
	else_if = {
		limit = {
			has_government = social_democrat
		}
		multiply_variable = { IBR_TBA_resources_gain = -0.4 }
	}
	add_to_variable = { IBR_TBA_Resources = IBR_TBA_resources_gain }
	
	clamp_variable = {
		var = IBR_TBA_Activity
		min = -1
		max = 10
	}
	clamp_variable = {
		var = IBR_TBA_Resources
		min = -1
		max = 10
	}
	clamp_variable = {
		var = IBR_TBA_Support
		min = -1
		max = 10
	}
}

IBR_ETA_ticker = {
	###For each separatist group - support gain

	set_variable = { IBR_ETA_support_gain = 0.15 }
	set_temp_variable = { IBR_ETA_support_gain_mult = IBR_ETA_Support }
	multiply_temp_variable = { IBR_ETA_support_gain_mult = 0.33 }
	if = {
		limit = {
			NOT = {
				check_variable = { IBR_ETA_support_gain_mult < 1 }
			}
		}
		multiply_variable = { IBR_ETA_support_gain = IBR_ETA_support_gain_mult }
	}
	
	if = {
		limit = {
			has_government = authoritarian_democrat
		}
		multiply_variable = { IBR_ETA_support_gain = 0.7 }
	}
	if = {
		limit = {
			has_government = social_conservative
		}
		multiply_variable = { IBR_ETA_support_gain = 0.4 }
	}
	else_if = {
		limit = {
			has_government = market_liberal
		}
		multiply_variable = { IBR_ETA_support_gain = 0.1 }
	}
	if = {
		limit = {
			has_government = social_liberal
		}
		multiply_variable = { IBR_ETA_support_gain = -0.1 }
	}
	else_if = {
		limit = {
			has_government = social_democrat
		}
		multiply_variable = { IBR_ETA_support_gain = -0.4 }
	}
	add_to_variable = { IBR_ETA_Support = IBR_ETA_support_gain }

	###For each separatist group - activity gain

	set_variable = { IBR_ETA_activity_gain = 0.075 }
	set_temp_variable = { IBR_ETA_activity_gain_add = IBR_ETA_Support }
	multiply_temp_variable = { IBR_ETA_activity_gain_add = 0.125 }
	add_to_variable = { IBR_ETA_activity_gain = IBR_ETA_activity_gain_add }
	
	if = {
		limit = {
			has_government = authoritarian_democrat
		}
		multiply_variable = { IBR_ETA_activity_gain = 0.7 }
	}
	if = {
		limit = {
			has_government = social_conservative
		}
		multiply_variable = { IBR_ETA_activity_gain = 0.4 }
	}
	else_if = {
		limit = {
			has_government = market_liberal
		}
		multiply_variable = { IBR_ETA_activity_gain = 0.1 }
	}
	if = {
		limit = {
			has_government = social_liberal
		}
		multiply_variable = { IBR_ETA_activity_gain = -0.1 }
	}
	else_if = {
		limit = {
			has_government = social_democrat
		}
		multiply_variable = { IBR_ETA_activity_gain = -0.4 }
	}
	add_to_variable = { IBR_ETA_Activity = IBR_ETA_activity_gain }

	###For each separatist group - supply gain

	set_variable = { IBR_ETA_resources_gain = 0.075 }
	set_temp_variable = { IBR_ETA_resources_gain_add = IBR_ETA_Support }
	multiply_temp_variable = { IBR_ETA_resources_gain_add = 0.125 }
	add_to_variable = { IBR_ETA_resources_gain = IBR_ETA_resources_gain_add } 
	
	if = {
		limit = {
			has_government = authoritarian_democrat
		}
		multiply_variable = { IBR_ETA_resources_gain = 0.7 }
	}
	if = {
		limit = {
			has_government = social_conservative
		}
		multiply_variable = { IBR_ETA_resources_gain = 0.4 }
	}
	else_if = {
		limit = {
			has_government = market_liberal
		}
		multiply_variable = { IBR_ETA_resources_gain = 0.1 }
	}
	if = {
		limit = {
			has_government = social_liberal
		}
		multiply_variable = { IBR_ETA_resources_gain = -0.1 }
	}
	else_if = {
		limit = {
			has_government = social_democrat
		}
		multiply_variable = { IBR_ETA_resources_gain = -0.4 }
	}
	add_to_variable = { IBR_ETA_Resources = IBR_ETA_resources_gain }
	
	clamp_variable = {
		var = IBR_ETA_Activity
		min = -1
		max = 10
	}
	clamp_variable = {
		var = IBR_ETA_Resources
		min = -1
		max = 10
	}
	clamp_variable = {
		var = IBR_ETA_Support
		min = -1
		max = 10
	}
}
IBR_FSLP_ticker = {
	###For each separatist group - support gain

	set_variable = { IBR_FSLP_support_gain = 0.15 }
	set_temp_variable = { IBR_FSLP_support_gain_mult = IBR_FSLP_Support }
	multiply_temp_variable = { IBR_FSLP_support_gain_mult = 0.33 }
	if = {
		limit = {
			NOT = {
				check_variable = { IBR_FSLP_support_gain_mult < 1 }
			}
		}
		multiply_variable = { IBR_FSLP_support_gain = IBR_FSLP_support_gain_mult }
	}
	
	if = {
		limit = {
			has_government = authoritarian_democrat
		}
		multiply_variable = { IBR_FSLP_support_gain = 0.7 }
	}
	if = {
		limit = {
			has_government = social_conservative
		}
		multiply_variable = { IBR_FSLP_support_gain = 0.4 }
	}
	else_if = {
		limit = {
			has_government = market_liberal
		}
		multiply_variable = { IBR_FSLP_support_gain = 0.1 }
	}
	if = {
		limit = {
			has_government = social_liberal
		}
		multiply_variable = { IBR_FSLP_support_gain = -0.1 }
	}
	else_if = {
		limit = {
			has_government = social_democrat
		}
		multiply_variable = { IBR_FSLP_support_gain = -0.4 }
	}
	add_to_variable = { IBR_FSLP_Support = IBR_FSLP_support_gain }

	###For each separatist group - activity gain

	set_variable = { IBR_FSLP_activity_gain = 0.075 }
	set_temp_variable = { IBR_FSLP_activity_gain_add = IBR_FSLP_Support }
	multiply_temp_variable = { IBR_FSLP_activity_gain_add = 0.125 }
	add_to_variable = { IBR_FSLP_activity_gain = IBR_FSLP_activity_gain_add }
	
	if = {
		limit = {
			has_government = authoritarian_democrat
		}
		multiply_variable = { IBR_FSLP_activity_gain = 0.7 }
	}
	if = {
		limit = {
			has_government = social_conservative
		}
		multiply_variable = { IBR_FSLP_activity_gain = 0.4 }
	}
	else_if = {
		limit = {
			has_government = market_liberal
		}
		multiply_variable = { IBR_FSLP_activity_gain = 0.1 }
	}
	if = {
		limit = {
			has_government = social_liberal
		}
		multiply_variable = { IBR_FSLP_activity_gain = -0.1 }
	}
	else_if = {
		limit = {
			has_government = social_democrat
		}
		multiply_variable = { IBR_FSLP_activity_gain = -0.4 }
	}
	add_to_variable = { IBR_FSLP_Activity = IBR_FSLP_activity_gain }

	###For each separatist group - supply gain

	set_variable = { IBR_FSLP_resources_gain = 0.075 }
	set_temp_variable = { IBR_FSLP_resources_gain_add = IBR_FSLP_Support }
	multiply_temp_variable = { IBR_FSLP_resources_gain_add = 0.125 }
	add_to_variable = { IBR_FSLP_resources_gain = IBR_FSLP_resources_gain_add } 
	
	if = {
		limit = {
			has_government = authoritarian_democrat
		}
		multiply_variable = { IBR_FSLP_resources_gain = 0.7 }
	}
	if = {
		limit = {
			has_government = social_conservative
		}
		multiply_variable = { IBR_FSLP_resources_gain = 0.4 }
	}
	else_if = {
		limit = {
			has_government = market_liberal
		}
		multiply_variable = { IBR_FSLP_resources_gain = 0.1 }
	}
	if = {
		limit = {
			has_government = social_liberal
		}
		multiply_variable = { IBR_FSLP_resources_gain = -0.1 }
	}
	else_if = {
		limit = {
			has_government = social_democrat
		}
		multiply_variable = { IBR_FSLP_resources_gain = -0.4 }
	}
	add_to_variable = { IBR_FSLP_Resources = IBR_FSLP_resources_gain }
	
	clamp_variable = {
		var = IBR_FSLP_Activity
		min = -1
		max = 10
	}
	clamp_variable = {
		var = IBR_FSLP_Resources
		min = -1
		max = 10
	}
	clamp_variable = {
		var = IBR_FSLP_Support
		min = -1
		max = 10
	}
}

IBR_AAS_resources_ticker = {
	if = {
		limit = {
			OR = {
				has_country_flag = IBRChoseCongress
				has_country_flag = IBRChoseUnion
				AND = {
					has_country_flag = IBR_AAS_chain_goodending
					has_country_flag = IBR_Salazar_dead
				}
			}
		}
		add_to_variable = {
			var = IBR_AAS_Resources
			value = 6
		}
	}
	else_if = {
		limit = {
			OR = {
				has_country_flag = IBR_AAS_chain_goodending
				AND = {
					has_country_flag = IBR_AAS_chain_midending
					has_country_flag = IBR_Salazar_dead
				}
				AND = {
					has_country_flag = IBR_AAS_chain_badending
					has_country_flag = IBR_Salazar_dead
				}
			}
		}
		add_to_variable = {
			var = IBR_AAS_Resources
			value = 5
		}
	}
	else_if = {
		limit = {
			OR = {
				has_country_flag = IBR_AAS_chain_midending
				AND = {
					has_country_flag = IBR_AAS_chain_worstending
					has_country_flag = IBR_Salazar_dead
				}
			}
		}
		add_to_variable = {
			var = IBR_AAS_Resources
			value = 4
		}
	}
	else_if = {
		limit = {
			has_country_flag = IBR_AAS_chain_start
		}
		add_to_variable = {
			var = IBR_AAS_Resources
			value = 2
		}
	}
	else = {
		add_to_variable = {
			var = IBR_AAS_Resources
			value = 1
		}
	}
}
IBR_clear_AAS_chain_flags = { #put this at start of 1970 paths
	clr_country_flag = IBR_AAS_chain_start
	clr_country_flag = IBR_AAS_chain_goodending
	clr_country_flag = IBR_AAS_chain_midending
	clr_country_flag = IBR_AAS_chain_badending
	clr_country_flag = IBR_AAS_chain_worstending
}

white_peace_iberian_wars = {
	if = {
		limit = {
			has_war_with = IBR
		}
		white_peace = IBR
	}
	if = {
		limit = {
			has_war_with = SPA
		}
		white_peace = SPA
	}
	if = {
		limit = {
			has_war_with = SPR
		}
		white_peace = SPR
	}
	if = {
		limit = {
			has_war_with = SPS
		}
		white_peace = SPS
	}
	if = {
		limit = {
			has_war_with = POR
		}
		white_peace = POR
	}
	if = {
		limit = {
			has_war_with = PRT
		}
		white_peace = PRT
	}
	if = {
		limit = {
			has_war_with = PPR
		}
		white_peace = PPR
	}
	if = {
		limit = {
			has_war_with = RPP
		}
		white_peace = RPP
	}
	if = {
		limit = {
			has_war_with = GNS
		}
		white_peace = GNS
	}
	if = {
		limit = {
			has_war_with = FSR
		}
		white_peace = FSR
	}
	if = {
		limit = {
			has_war_with = CTL
		}
		white_peace = CTL
	}
	if = {
		limit = {
			has_war_with = CNT
		}
		white_peace = CNT
	}
	if = {
		limit = {
			has_war_with = ETA
		}
		white_peace = ETA
	}
	if = {
		limit = {
			has_war_with = BSQ
		}
		white_peace = BSQ
	}
	if = {
		limit = {
			has_war_with = GAL
		}
		white_peace = GAL
	}
	if = {
		limit = {
			has_war_with = TBA
		}
		white_peace = TBA
	}
}
IBR_check_caudillo_popularity = {
	
	clamp_variable = {
		var = IBR_military_alignment
		min = -20
		max = 20
	}
	clamp_variable = {
		var = IBR_church_alignment
		min = -20
		max = 20
	}
	clamp_variable = {
		var = IBR_business_alignment
		min = -15
		max = 15
	}
	clamp_variable = {
		var = IBR_intellectual_alignment
		min = -15
		max = 15
	}
	clamp_variable = {
		var = IBR_foreign_alignment
		min = -15
		max = 15
	}
	clamp_variable = {
		var = IBR_burocrat_alignment
		min = -10
		max = 10
	}
	clamp_variable = {
		var = IBR_settlers_alignment
		min = -10
		max = 10
	}
	clamp_variable = {
		var = IBR_native_alignment
		min = -10
		max = 10
	}
	clamp_variable = {
		var = IBR_majority_alignment
		min = -10
		max = 10
	}
	clamp_variable = {
		var = IBR_regional_alignment
		min = -10
		max = 10
	}
	set_temp_variable = { caudillo_temp_variable = 0 } 
	add_to_temp_variable = {caudillo_temp_variable = IBR_military_alignment} 
	add_to_temp_variable = {caudillo_temp_variable = IBR_church_alignment} 
	add_to_temp_variable = {caudillo_temp_variable = IBR_burocrat_alignment} 
	add_to_temp_variable = {caudillo_temp_variable = IBR_business_alignment} 
	add_to_temp_variable = {caudillo_temp_variable = IBR_settlers_alignment} 
	add_to_temp_variable = {caudillo_temp_variable = IBR_native_alignment} 
	add_to_temp_variable = {caudillo_temp_variable = IBR_foreign_alignment} 
	add_to_temp_variable = {caudillo_temp_variable = IBR_intellectual_alignment} 
	add_to_temp_variable = {caudillo_temp_variable = IBR_majority_alignment} 
	add_to_temp_variable = {caudillo_temp_variable = IBR_regional_alignment}	
	if = {
		limit = { 
			check_variable = {
    		var = caudillo_temp_variable
    		value = 40
    		compare = greater_than_or_equals
			}
		}
        clr_country_flag = cau_council
	    clr_country_flag = cau_weak_salazar
	    clr_country_flag = cau_strong_salazar
        clr_country_flag = cau_weak_franco
        if = { 
            limit = { 
                NOT = { 
                    has_country_flag = cau_strong_franco
                }
            }
            set_country_flag = cau_strong_franco
            custom_effect_tooltip = cau_strong_franco_tt
        }
		hidden_effect = {
		create_country_leader = {
			name = "Francisco Franco"
			desc = "POLITICS_FRANCISCO_FRANCO_DESC"
			picture = "Portrait_Iberia_Francisco_Franco.dds"
			expire = "1981.10.20"
			ideology = despotism_subtype
			traits = {
				strong_franco_trait
			}
		}
		remove_ideas = IBR_Iberian_Council_dep
		remove_ideas = IBR_Francisco_Franco_dep 
		add_ideas = IBR_Antonio_Salazar_dep
		}
	} 
	else_if = {
		limit = { 
				AND = { 
				check_variable = {
    			var = caudillo_temp_variable
    			value = 40
    			compare = less_than
					}
				check_variable = {
    			var = caudillo_temp_variable
    			value = 5
    			compare = greater_than_or_equals
					}
				}
		}
		clr_country_flag = cau_council
	    clr_country_flag = cau_weak_salazar
	    clr_country_flag = cau_strong_salazar
        clr_country_flag = cau_strong_franco
        if = { 
            limit = { 
                NOT = { 
                    has_country_flag = cau_weak_franco
                }
            }
            set_country_flag = cau_weak_franco
            custom_effect_tooltip = cau_weak_franco_tt
        }
		hidden_effect = {
		create_country_leader = {
			name = "Francisco Franco"
			desc = "POLITICS_FRANCISCO_FRANCO_DESC"
			picture = "Portrait_Iberia_Francisco_Franco.dds"
			expire = "1981.10.20"
			ideology = despotism_subtype
			traits = {
				weak_franco_trait
			}
		}
		remove_ideas = IBR_Iberian_Council_dep
		remove_ideas = IBR_Francisco_Franco_dep 
		add_ideas = IBR_Antonio_Salazar_dep
		}
	}  
	else_if = {
		limit = { 
				AND = { 
				check_variable = {
    			var = caudillo_temp_variable
    			value = 5
    			compare = less_than
					}
				check_variable = {
    			var = caudillo_temp_variable
    			value = -5
    			compare = greater_than_or_equals
					}
				}
		}
		clr_country_flag = cau_weak_franco
	    clr_country_flag = cau_weak_salazar
	    clr_country_flag = cau_strong_salazar
        clr_country_flag = cau_strong_franco
        if = { 
            limit = { 
                NOT = { 
                    has_country_flag = cau_council
                }
            }
            set_country_flag = cau_council
            custom_effect_tooltip = cau_council_tt
        }
		hidden_effect = {
		create_country_leader = {
			name = "Iberian Council"
			desc = "POLITICS_IBERIAN_COUNCIL_PRE68"
			picture = "Portrait_Iberia_Iberian_Council.dds"
			expire = "1981.10.20"
			ideology = despotism_subtype
			traits = {
				iberian_council_trait
			}
		}
		remove_ideas = IBR_Francisco_Franco_dep
		remove_ideas = IBR_Antonio_Salazar_dep
		add_ideas = IBR_Iberian_Council_dep	
		}
	} 
	else_if = {
		limit = { 
				AND = { 
				check_variable = {
    			var = caudillo_temp_variable
    			value = -5
    			compare = less_than
					}
				check_variable = {
    			var = caudillo_temp_variable
    			value = -40
    			compare = greater_than_or_equals
					}
				}
		}
		clr_country_flag = cau_weak_franco
	    clr_country_flag = cau_council
	    clr_country_flag = cau_strong_salazar
        clr_country_flag = cau_strong_franco
        if = { 
            limit = { 
                NOT = { 
                    has_country_flag = cau_weak_salazar
                }
            }
            set_country_flag = cau_weak_salazar
            custom_effect_tooltip = cau_weak_salazar_tt
        }
		hidden_effect = {
		create_country_leader = {
			name = "António de Oliveira Salazar"
			desc = "POLITICS_ANTONIO_DE_OLIVEIRA_SALAZAR_IBERIA_DESC"
			picture = "Portrait_Iberia_Antonio_Salazar.dds"
			expire = "1981.10.20"
			ideology = despotism_subtype
			traits = {
				weak_salazar_trait
			}
		}
		remove_ideas = IBR_Iberian_Council_dep
		remove_ideas = IBR_Antonio_Salazar_dep
		add_ideas = IBR_Francisco_Franco_dep
		}
	} 
	else_if = {
		limit = { 
				check_variable = {
    			var = caudillo_temp_variable
    			value = -40
    			compare = less_than
					}	
		}
		clr_country_flag = cau_weak_franco
	    clr_country_flag = cau_weak_salazar
	    clr_country_flag = cau_council
        clr_country_flag = cau_strong_franco
        if = { 
            limit = { 
                NOT = { 
                    has_country_flag = cau_strong_salazar
                }
            }
            set_country_flag = cau_strong_salazar
             custom_effect_tooltip = cau_strong_salazar_tt
        }
		hidden_effect = {
		create_country_leader = {
			name = "António de Oliveira Salazar"
			desc = "POLITICS_ANTONIO_DE_OLIVEIRA_SALAZAR_IBERIA_DESC"
			picture = "Portrait_Iberia_Antonio_Salazar.dds"
			expire = "1981.10.20"
			ideology = despotism_subtype
			traits = {
				strong_salazar_trait 
			}
		}
		remove_ideas = IBR_Iberian_Council_dep
		remove_ideas = IBR_Antonio_Salazar_dep
		add_ideas = IBR_Francisco_Franco_dep
		}
	}
	IBR_update_caudillo_progress_bar = yes 
	if = {
		limit = { 
			check_variable = {
    			var = caudillo_temp_variable
    			value = 0
    			compare = greater_than
			}	
		}
		clr_country_flag = cau_salazar_lead
		set_country_flag = cau_franco_lead
	}
	else_if = {
		limit = { 
			check_variable = {
    			var = caudillo_temp_variable
    			value = 0
    			compare = less_than
			}	
		}
		clr_country_flag = cau_franco_lead
		set_country_flag = cau_salazar_lead
	}
	else_if = {
		limit = { 
			check_variable = { caudillo_temp_variable = 0 }
		}
		clr_country_flag = cau_salazar_lead
		clr_country_flag = cau_franco_lead
	}
}

IBR_add_3_socdem = {
	#custom_effect_tooltip = IBR_add_3_socdem_tt
		add_to_variable = { IBRIzquierdaPopularity = 3 }
		add_popularity = {
			ideology = social_democrat
			popularity = 0.01
		}	
}
IBR_add_5_socdem = {
	#custom_effect_tooltip = IBR_add_5_socdem_tt
		add_to_variable = { IBRIzquierdaPopularity = 5 }
		add_popularity = {
			ideology = social_democrat
			popularity = 0.025	
		}
	
}
IBR_add_10_socdem = {
	##custom_effect_tooltip = IBR_add_10_socdem_tt
	 
		add_to_variable = { IBRIzquierdaPopularity = 10 }
		add_popularity = {
			ideology = social_democrat
			popularity = 0.05	
		}
	
}
IBR_add_15_socdem = {
	#custom_effect_tooltip = IBR_add_15_socdem_tt
	 
		add_to_variable = { IBRIzquierdaPopularity = 15 }
		add_popularity = {
			ideology = social_democrat
			popularity = 0.075	
		}
	
}

IBR_add_20_socdem = {
	#custom_effect_tooltip = IBR_add_20_socdem_tt
	 
		add_to_variable = { IBRIzquierdaPopularity = 20 }
		add_popularity = {
			ideology = social_democrat
			popularity = 0.1	
		}
	
}

IBR_add_25_socdem = {
	#custom_effect_tooltip = IBR_add_25_socdem_tt
	 
		add_to_variable = { IBRIzquierdaPopularity = 25 }
		add_popularity = {
			ideology = social_democrat
			popularity = 0.125
		}
	
}

IBR_add_30_socdem = {
	#custom_effect_tooltip = IBR_add_30_socdem_tt
	 
		add_to_variable = { IBRIzquierdaPopularity = 30 }
		add_popularity = {
			ideology = social_democrat
			popularity = 0.15	
		}
	
}

IBR_add_random_socdem = {
	custom_effect_tooltip = IBR_add_random_socdem_tt
	hidden_effect = {
		random_list = {
			25 = {
				add_to_variable = { IBRIzquierdaPopularity = 2 }
				add_popularity = {
					ideology = social_democrat
					popularity = 0.005
				}
			}
			25 = {
				add_to_variable = { IBRIzquierdaPopularity = 3 }
				add_popularity = {
					ideology = social_democrat
					popularity = 0.01	
				}
			}
			25 = {
				add_to_variable = { IBRIzquierdaPopularity = 4 }
				add_popularity = {
					ideology = social_democrat
					popularity = 0.02	
				}
			}
			25 = {
				add_to_variable = { IBRIzquierdaPopularity = 5 }
				add_popularity = {
					ideology = social_democrat
					popularity = 0.025
				}
			}
		}
	}
	
}
IBR_sub_3_socdem = {
	#custom_effect_tooltip = IBR_sub_3_socdem_tt
	 
		subtract_from_variable = { IBRIzquierdaPopularity = 3 }
		add_popularity = {
			ideology = social_democrat
			popularity = -0.01
		}
		clamp_variable = {
			var = IBRIzquierdaPopularity
			min = 0
			max = 10000
		}
	
}
IBR_sub_5_socdem = {	
	#custom_effect_tooltip = IBR_sub_5_socdem
	 
		subtract_from_variable = { IBRIzquierdaPopularity = 5 }
		add_popularity = {
			ideology = social_democrat
			popularity = -0.025
		}
		clamp_variable = {
			var = IBRIzquierdaPopularity
			min = 0
			max = 10000
		}
	
}
IBR_sub_10_socdem = {
	#custom_effect_tooltip = IBR_sub_10_socdem_tt
	 
		subtract_from_variable = { IBRIzquierdaPopularity = 10 }
		add_popularity = {
			ideology = social_democrat
			popularity = -0.05
		}
		clamp_variable = {
			var = IBRIzquierdaPopularity
			min = 0
			max = 10000
		}
	
}
IBR_sub_15_socdem = {
	#custom_effect_tooltip = IBR_sub_15_socdem_tt
	 
		subtract_from_variable = { IBRIzquierdaPopularity = 15 }
		add_popularity = {
			ideology = social_democrat
			popularity = -0.075	
		}
		clamp_variable = {
			var = IBRIzquierdaPopularity
			min = 0
			max = 10000
		}
	
}
IBR_sub_20_socdem = {
	#custom_effect_tooltip = IBR_sub_20_socdem_tt
	 
		subtract_from_variable = { IBRIzquierdaPopularity = 20 }
		add_popularity = {
			ideology = social_democrat
			popularity = -0.1	
		}
		clamp_variable = {
			var = IBRIzquierdaPopularity
			min = 0
			max = 10000
		}
	
}

IBR_sub_25_socdem = {
	#custom_effect_tooltip = IBR_sub_25_socdem_tt
	 
		subtract_from_variable = { IBRIzquierdaPopularity = 25 }
		add_popularity = {
			ideology = social_democrat
			popularity = -0.125
		}
		clamp_variable = {
			var = IBRIzquierdaPopularity
			min = 0
			max = 10000
		}
	
}

IBR_sub_30_socdem = {
	#custom_effect_tooltip = IBR_sub_30_socdem_tt
	
		subtract_from_variable = { IBRIzquierdaPopularity = 30 }
		add_popularity = {
			ideology = social_democrat
			popularity = -0.15	
		}
		clamp_variable = {
			var = IBRIzquierdaPopularity
			min = 0
			max = 10000
		}
	
}
IBR_sub_random_socdem = {
	#custom_effect_tooltip = IBR_sub_random_socdem_tt
	hidden_effect = { 
		random_list = {
			20 = {
				subtract_from_variable = { IBRIzquierdaPopularity = 1 }
				add_popularity = {
					ideology = social_democrat
					popularity = -0.01
				}
			}
			20 = {
				subtract_from_variable = { IBRIzquierdaPopularity = 2 }
				add_popularity = {
					ideology = social_democrat
					popularity = -0.02
				}
			}
			20 = {
				subtract_from_variable = { IBRIzquierdaPopularity = 3 }
				add_popularity = {
					ideology = social_democrat
					popularity = -0.03	
				}
			}
			20 = {
				subtract_from_variable = { IBRIzquierdaPopularity = 4 }
				add_popularity = {
					ideology = social_democrat
					popularity = -0.04	
				}
			}
			20 = {
				subtract_from_variable = { IBRIzquierdaPopularity = 5 }
				add_popularity = {
					ideology = social_democrat
					popularity = -0.05
				}
			}
		}
		clamp_variable = {
			var = IBRIzquierdaPopularity
			min = 0
			max = 10000
		}
	}
}
IBR_add_3_soccon = {
	#custom_effect_tooltip = IBR_add_3_soccon_tt
	 
		add_to_variable = { IBRAlianzaPopularPopularity = 3 }
		add_popularity = {
			ideology = social_conservative
			popularity = 0.01
		}	
	
}
IBR_add_5_soccon = {
	#custom_effect_tooltip = IBR_add_5_soccon_tt
	 
		add_to_variable = { IBRAlianzaPopularPopularity = 5 }
		add_popularity = {
			ideology = social_conservative
			popularity = 0.025	
		}
	
	
}
IBR_add_10_soccon = {
	#custom_effect_tooltip = IBR_add_10_soccon_tt
	 
		add_to_variable = { IBRAlianzaPopularPopularity = 10 }
		add_popularity = {
			ideology = social_conservative
			popularity = 0.05	
		}
	
}
IBR_add_15_soccon = {
	#custom_effect_tooltip = IBR_add_15_soccon_tt
	 
		add_to_variable = { IBRAlianzaPopularPopularity = 15 }
		add_popularity = {
			ideology = social_conservative
			popularity = 0.075	
		}
	
}

IBR_add_20_soccon = {
	#custom_effect_tooltip = IBR_add_20_soccon_tt
	 
		add_to_variable = { IBRAlianzaPopularPopularity = 20 }
		add_popularity = {
			ideology = social_conservative
			popularity = 0.1	
		}
	
}

IBR_add_25_soccon = {
	#custom_effect_tooltip = IBR_add_25_soccon_tt
	 
		add_to_variable = { IBRAlianzaPopularPopularity = 25 }
		add_popularity = {
			ideology = social_conservative
			popularity = 0.125
		}
	
}

IBR_add_30_soccon = {
	#custom_effect_tooltip = IBR_add_30_soccon_tt
	 
		add_to_variable = { IBRAlianzaPopularPopularity = 30 }
		add_popularity = {
			ideology = social_conservative
			popularity = 0.15	
		}
	
}

IBR_add_random_soccon = {
	custom_effect_tooltip = IBR_add_random_soccon_tt
	hidden_effect = { 
		random_list = {
			25 = {
				add_to_variable = { IBRAlianzaPopularPopularity = 2 }
				add_popularity = {
					ideology = social_conservative
					popularity = 0.005
				}
			}
			25 = {
				add_to_variable = { IBRAlianzaPopularPopularity = 3 }
				add_popularity = {
					ideology = social_conservative
					popularity = 0.01	
				}
			}
			25 = {
				add_to_variable = { IBRAlianzaPopularPopularity = 4 }
				add_popularity = {
					ideology = social_conservative
					popularity = 0.02	
				}
			}
			25 = {
				add_to_variable = { IBRAlianzaPopularPopularity = 5 }
				add_popularity = {
					ideology = social_conservative
					popularity = 0.025
				}
			}
		}
	}
	
}
IBR_sub_3_soccon = {
	#custom_effect_tooltip = IBR_sub_3_soccon_tt
	 
		subtract_from_variable = { IBRAlianzaPopularPopularity = 3 }
		add_popularity = {
			ideology = social_conservative
			popularity = -0.01
		}
		clamp_variable = {
			var = IBRAlianzaPopularPopularity
			min = 0
			max = 10000
		}
	
}
IBR_sub_5_soccon = {	
	#custom_effect_tooltip = IBR_sub_5_soccon
	 
		subtract_from_variable = { IBRAlianzaPopularPopularity = 5 }
		add_popularity = {
			ideology = social_conservative
			popularity = -0.025
		}
		clamp_variable = {
			var = IBRAlianzaPopularPopularity
			min = 0
			max = 10000
		}
	
}
IBR_sub_10_soccon = {
	#custom_effect_tooltip = IBR_sub_10_soccon_tt
	 
		subtract_from_variable = { IBRAlianzaPopularPopularity = 10 }
		add_popularity = {
			ideology = social_conservative
			popularity = -0.05
		}
		clamp_variable = {
			var = IBRAlianzaPopularPopularity
			min = 0
			max = 10000
		}
	
}
IBR_sub_15_soccon = {
	#custom_effect_tooltip = IBR_sub_15_soccon_tt
	 
		subtract_from_variable = { IBRAlianzaPopularPopularity = 15 }
		add_popularity = {
			ideology = social_conservative
			popularity = -0.075	
		}
		clamp_variable = {
			var = IBRAlianzaPopularPopularity
			min = 0
			max = 10000
		}
	
}
IBR_sub_20_soccon = {
	#custom_effect_tooltip = IBR_sub_20_soccon_tt
	 
		subtract_from_variable = { IBRAlianzaPopularPopularity = 20 }
		add_popularity = {
			ideology = social_conservative
			popularity = -0.1	
		}
		clamp_variable = {
			var = IBRAlianzaPopularPopularity
			min = 0
			max = 10000
		}

}

IBR_sub_25_soccon = {
	#custom_effect_tooltip = IBR_sub_25_soccon_tt
	 
		subtract_from_variable = { IBRAlianzaPopularPopularity = 25 }
		add_popularity = {
			ideology = social_conservative
			popularity = -0.125
		}
		clamp_variable = {
			var = IBRAlianzaPopularPopularity
			min = 0
			max = 10000
		}
	
}

IBR_sub_30_soccon = {
	#custom_effect_tooltip = IBR_sub_30_soccon_tt
	
		subtract_from_variable = { IBRAlianzaPopularPopularity = 30 }
		add_popularity = {
			ideology = social_conservative
			popularity = -0.15	
		}
		clamp_variable = {
			var = IBRAlianzaPopularPopularity
			min = 0
			max = 10000
		}
	
}
IBR_sub_random_soccon = {
	#custom_effect_tooltip = IBR_sub_random_soccon_tt
	hidden_effect = { 
		random_list = {
			20 = {
				subtract_from_variable = { IBRAlianzaPopularPopularity = 1 }
				add_popularity = {
					ideology = social_conservative
					popularity = -0.01
				}
			}
			20 = {
				subtract_from_variable = { IBRAlianzaPopularPopularity = 2 }
				add_popularity = {
					ideology = social_conservative
					popularity = -0.02
				}
			}
			20 = {
				subtract_from_variable = { IBRAlianzaPopularPopularity = 3 }
				add_popularity = {
					ideology = social_conservative
					popularity = -0.03	
				}
			}
			20 = {
				subtract_from_variable = { IBRAlianzaPopularPopularity = 4 }
				add_popularity = {
					ideology = social_conservative
					popularity = -0.04	
				}
			}
			20 = {
				subtract_from_variable = { IBRAlianzaPopularPopularity = 5 }
				add_popularity = {
					ideology = social_conservative
					popularity = -0.05
				}
			}
		}
		clamp_variable = {
			var = IBRAlianzaPopularPopularity
			min = 0
			max = 10000
		}
	}
}
IBR_add_3_authdem = {
	#custom_effect_tooltip = IBR_add_3_authdem_tt
	 
		add_to_variable = { IBRNationalUnionPopularity = 3 }
		add_popularity = {
			ideology = authoritarian_democrat
			popularity = 0.01
		}	
	
}
IBR_add_5_authdem = {
	#custom_effect_tooltip = IBR_add_5_authdem_tt
	 
		add_to_variable = { IBRNationalUnionPopularity = 5 }
		add_popularity = {
			ideology = authoritarian_democrat
			popularity = 0.025	
		}
	
	
}
IBR_add_10_authdem = {
	#custom_effect_tooltip = IBR_add_10_authdem_tt
	 
		add_to_variable = { IBRNationalUnionPopularity = 10 }
		add_popularity = {
			ideology = authoritarian_democrat
			popularity = 0.05	
		}
	
}
IBR_add_15_authdem = {
	#custom_effect_tooltip = IBR_add_15_authdem_tt
	 
		add_to_variable = { IBRNationalUnionPopularity = 15 }
		add_popularity = {
			ideology = authoritarian_democrat
			popularity = 0.075	
		}
	
}

IBR_add_20_authdem = {
	#custom_effect_tooltip = IBR_add_20_authdem_tt
	 
		add_to_variable = { IBRNationalUnionPopularity = 20 }
		add_popularity = {
			ideology = authoritarian_democrat
			popularity = 0.1	
		}
	
}

IBR_add_25_authdem = {
	#custom_effect_tooltip = IBR_add_25_authdem_tt
	 
		add_to_variable = { IBRNationalUnionPopularity = 25 }
		add_popularity = {
			ideology = authoritarian_democrat
			popularity = 0.125
		}
	
}

IBR_add_30_authdem = {
	#custom_effect_tooltip = IBR_add_30_authdem_tt
	 
		add_to_variable = { IBRNationalUnionPopularity = 30 }
		add_popularity = {
			ideology = authoritarian_democrat
			popularity = 0.15	
		}
	
}

IBR_add_random_authdem = {
	custom_effect_tooltip = IBR_add_random_authdem_tt
	hidden_effect = { 
		random_list = {
			25 = {
				add_to_variable = { IBRNationalUnionPopularity = 2 }
				add_popularity = {
					ideology = authoritarian_democrat
					popularity = 0.005
				}
			}
			25 = {
				add_to_variable = { IBRNationalUnionPopularity = 3 }
				add_popularity = {
					ideology = authoritarian_democrat
					popularity = 0.01	
				}
			}
			25 = {
				add_to_variable = { IBRNationalUnionPopularity = 4 }
				add_popularity = {
					ideology = authoritarian_democrat
					popularity = 0.02	
				}
			}
			25 = {
				add_to_variable = { IBRNationalUnionPopularity = 5 }
				add_popularity = {
					ideology = authoritarian_democrat
					popularity = 0.025
				}
			}
		}
	}
	
}
IBR_sub_3_authdem = {
	#custom_effect_tooltip = IBR_sub_3_authdem_tt
	 
		subtract_from_variable = { IBRNationalUnionPopularity = 3 }
		add_popularity = {
			ideology = authoritarian_democrat
			popularity = -0.01
		}
		clamp_variable = {
			var = IBRNationalUnionPopularity
			min = 0
			max = 10000
		}
	
}
IBR_sub_5_authdem = {	
	#custom_effect_tooltip = IBR_sub_5_authdem
	 
		subtract_from_variable = { IBRNationalUnionPopularity = 5 }
		add_popularity = {
			ideology = authoritarian_democrat
			popularity = -0.025
		}
		clamp_variable = {
			var = IBRNationalUnionPopularity
			min = 0
			max = 10000
		}
	
}
IBR_sub_10_authdem = {
	#custom_effect_tooltip = IBR_sub_10_authdem_tt
	 
		subtract_from_variable = { IBRNationalUnionPopularity = 10 }
		add_popularity = {
			ideology = authoritarian_democrat
			popularity = -0.05
		}
		clamp_variable = {
			var = IBRNationalUnionPopularity
			min = 0
			max = 10000
		}
	
}
IBR_sub_15_authdem = {
	#custom_effect_tooltip = IBR_sub_15_authdem_tt
	 
		subtract_from_variable = { IBRNationalUnionPopularity = 15 }
		add_popularity = {
			ideology = authoritarian_democrat
			popularity = -0.075	
		}
		clamp_variable = {
			var = IBRNationalUnionPopularity
			min = 0
			max = 10000
		}
	
}
IBR_sub_20_authdem = {
	#custom_effect_tooltip = IBR_sub_20_authdem_tt
	 
		subtract_from_variable = { IBRNationalUnionPopularity = 20 }
		add_popularity = {
			ideology = authoritarian_democrat
			popularity = -0.1	
		}
		clamp_variable = {
			var = IBRNationalUnionPopularity
			min = 0
			max = 10000
		}
	
}

IBR_sub_25_authdem = {
	#custom_effect_tooltip = IBR_sub_25_authdem_tt
	 
		subtract_from_variable = { IBRNationalUnionPopularity = 25 }
		add_popularity = {
			ideology = authoritarian_democrat
			popularity = -0.125
		}
		clamp_variable = {
			var = IBRNationalUnionPopularity
			min = 0
			max = 10000
		}
	
}

IBR_sub_30_authdem = {
	#custom_effect_tooltip = IBR_sub_30_authdem_tt
	
		subtract_from_variable = { IBRNationalUnionPopularity = 30 }
		add_popularity = {
			ideology = authoritarian_democrat
			popularity = -0.15	
		}
		clamp_variable = {
			var = IBRNationalUnionPopularity
			min = 0
			max = 10000
		}
	
}
IBR_sub_random_authdem = {
	#custom_effect_tooltip = IBR_sub_random_authdem_tt
	hidden_effect = { 
		random_list = {
			20 = {
				subtract_from_variable = { IBRNationalUnionPopularity = 1 }
				add_popularity = {
					ideology = authoritarian_democrat
					popularity = -0.01
				}
			}
			20 = {
				subtract_from_variable = { IBRNationalUnionPopularity = 2 }
				add_popularity = {
					ideology = authoritarian_democrat
					popularity = -0.02
				}
			}
			20 = {
				subtract_from_variable = { IBRNationalUnionPopularity = 3 }
				add_popularity = {
					ideology = authoritarian_democrat
					popularity = -0.03	
				}
			}
			20 = {
				subtract_from_variable = { IBRNationalUnionPopularity = 4 }
				add_popularity = {
					ideology = authoritarian_democrat
					popularity = -0.04	
				}
			}
			20 = {
				subtract_from_variable = { IBRNationalUnionPopularity = 5 }
				add_popularity = {
					ideology = authoritarian_democrat
					popularity = -0.05
				}
			}
		}
		clamp_variable = {
			var = IBRNationalUnionPopularity
			min = 0
			max = 10000
		}
	}
}
IBR_add_3_marklib = {
	#custom_effect_tooltip = IBR_add_3_marlib_tt
	 
		add_to_variable = { IBRMarketLiberalPopularity = 3 }
		add_popularity = {
			ideology = market_liberal
			popularity = 0.01
		}	
	
}
IBR_add_5_marklib = {
	#custom_effect_tooltip = IBR_add_5_marlib_tt
	 
		add_to_variable = { IBRMarketLiberalPopularity = 5 }
		add_popularity = {
			ideology = market_liberal
			popularity = 0.025	
		}
	
	
}
IBR_add_10_marklib = {
	#custom_effect_tooltip = IBR_add_10_marlib_tt
	 
		add_to_variable = { IBRMarketLiberalPopularity = 10 }
		add_popularity = {
			ideology = market_liberal
			popularity = 0.05	
		}
	
}
IBR_add_15_marklib = {
	#custom_effect_tooltip = IBR_add_15_marlib_tt
	 
		add_to_variable = { IBRMarketLiberalPopularity = 15 }
		add_popularity = {
			ideology = market_liberal
			popularity = 0.075	
		}
	
}

IBR_add_20_marklib = {
	#custom_effect_tooltip = IBR_add_20_marlib_tt
	 
		add_to_variable = { IBRMarketLiberalPopularity = 20 }
		add_popularity = {
			ideology = market_liberal
			popularity = 0.1	
		}
	
}

IBR_add_25_marklib = {
	#custom_effect_tooltip = IBR_add_25_marlib_tt
	 
		add_to_variable = { IBRMarketLiberalPopularity = 25 }
		add_popularity = {
			ideology = market_liberal
			popularity = 0.125
		}
	
}

IBR_add_30_marklib = {
	#custom_effect_tooltip = IBR_add_30_marlib_tt
	 
		add_to_variable = { IBRMarketLiberalPopularity = 30 }
		add_popularity = {
			ideology = market_liberal
			popularity = 0.15	
		}
	
}

IBR_add_random_marklib = {
	custom_effect_tooltip = IBR_add_random_marlib_tt
	hidden_effect = { 
		random_list = {
			25 = {
				add_to_variable = { IBRMarketLiberalPopularity = 2 }
				add_popularity = {
					ideology = market_liberal
					popularity = 0.005
				}
			}
			25 = {
				add_to_variable = { IBRMarketLiberalPopularity = 3 }
				add_popularity = {
					ideology = market_liberal
					popularity = 0.01	
				}
			}
			25 = {
				add_to_variable = { IBRMarketLiberalPopularity = 4 }
				add_popularity = {
					ideology = market_liberal
					popularity = 0.02	
				}
			}
			25 = {
				add_to_variable = { IBRMarketLiberalPopularity = 5 }
				add_popularity = {
					ideology = market_liberal
					popularity = 0.025
				}
			}
		}
	}
	
}
IBR_sub_3_marklib = {
	#custom_effect_tooltip = IBR_sub_3_marlib_tt
	 
		subtract_from_variable = { IBRMarketLiberalPopularity = 3 }
		add_popularity = {
			ideology = market_liberal
			popularity = -0.01
		}
		clamp_variable = {
			var = IBRMarketLiberalPopularity
			min = 0
			max = 10000
		}
	
}
IBR_sub_5_marklib = {	
	#custom_effect_tooltip = IBR_sub_5_marlib
	 
		subtract_from_variable = { IBRMarketLiberalPopularity = 5 }
		add_popularity = {
			ideology = market_liberal
			popularity = -0.025
		}
		clamp_variable = {
			var = IBRMarketLiberalPopularity
			min = 0
			max = 10000
		}
	
}
IBR_sub_10_marklib = {
	#custom_effect_tooltip = IBR_sub_10_marlib_tt
	 
		subtract_from_variable = { IBRMarketLiberalPopularity = 10 }
		add_popularity = {
			ideology = market_liberal
			popularity = -0.05
		}
		clamp_variable = {
			var = IBRMarketLiberalPopularity
			min = 0
			max = 10000
		}
	
}
IBR_sub_15_marklib = {
	#custom_effect_tooltip = IBR_sub_15_marlib_tt
	 
		subtract_from_variable = { IBRMarketLiberalPopularity = 15 }
		add_popularity = {
			ideology = market_liberal
			popularity = -0.075	
		}
		clamp_variable = {
			var = IBRMarketLiberalPopularity
			min = 0
			max = 10000
		}
	
}
IBR_sub_20_marklib = {
	#custom_effect_tooltip = IBR_sub_20_marlib_tt
	 
		subtract_from_variable = { IBRMarketLiberalPopularity = 20 }
		add_popularity = {
			ideology = market_liberal
			popularity = -0.1	
		}
		clamp_variable = {
			var = IBRMarketLiberalPopularity
			min = 0
			max = 10000
		}
	
}

IBR_sub_25_marklib = {
	#custom_effect_tooltip = IBR_sub_25_marlib_tt
	 
		subtract_from_variable = { IBRMarketLiberalPopularity = 25 }
		add_popularity = {
			ideology = market_liberal
			popularity = -0.125
		}
		clamp_variable = {
			var = IBRMarketLiberalPopularity
			min = 0
			max = 10000
		}
	
}

IBR_sub_30_marklib = {
	#custom_effect_tooltip = IBR_sub_30_marlib_tt
	
		subtract_from_variable = { IBRMarketLiberalPopularity = 30 }
		add_popularity = {
			ideology = market_liberal
			popularity = -0.15	
		}
		clamp_variable = {
			var = IBRMarketLiberalPopularity
			min = 0
			max = 10000
		}
	
}
IBR_sub_random_marklib = {
	#custom_effect_tooltip = IBR_sub_random_marlib_tt
	hidden_effect = { 
		random_list = {
			20 = {
				subtract_from_variable = { IBRMarketLiberalPopularity = 1 }
				add_popularity = {
					ideology = market_liberal
					popularity = -0.01
				}
			}
			20 = {
				subtract_from_variable = { IBRMarketLiberalPopularity = 2 }
				add_popularity = {
					ideology = market_liberal
					popularity = -0.02
				}
			}
			20 = {
				subtract_from_variable = { IBRMarketLiberalPopularity = 3 }
				add_popularity = {
					ideology = market_liberal
					popularity = -0.03	
				}
			}
			20 = {
				subtract_from_variable = { IBRMarketLiberalPopularity = 4 }
				add_popularity = {
					ideology = market_liberal
					popularity = -0.04	
				}
			}
			20 = {
				subtract_from_variable = { IBRMarketLiberalPopularity = 5 }
				add_popularity = {
					ideology = market_liberal
					popularity = -0.05
				}
			}
		}
		clamp_variable = {
			var = IBRMarketLiberalPopularity
			min = 0
			max = 10000
		}
	}
}
IBR_add_3_soclib = {
	#custom_effect_tooltip = IBR_add_3_soclib_tt
	 
		add_to_variable = { IBRIRMUDPopularity = 3 }
		add_popularity = {
			ideology = social_liberal
			popularity = 0.01
		}	
	
}
IBR_add_5_soclib = {
	#custom_effect_tooltip = IBR_add_5_soclib_tt
	 
		add_to_variable = { IBRIRMUDPopularity = 5 }
		add_popularity = {
			ideology = social_liberal
			popularity = 0.025	
		}
	
	
}
IBR_add_10_soclib = {
	#custom_effect_tooltip = IBR_add_10_soclib_tt
	 
		add_to_variable = { IBRIRMUDPopularity = 10 }
		add_popularity = {
			ideology = social_liberal
			popularity = 0.05	
		}
	
}
IBR_add_15_soclib = {
	#custom_effect_tooltip = IBR_add_15_soclib_tt
	 
		add_to_variable = { IBRIRMUDPopularity = 15 }
		add_popularity = {
			ideology = social_liberal
			popularity = 0.075	
		}
	
}

IBR_add_20_soclib = {
	#custom_effect_tooltip = IBR_add_20_soclib_tt
	 
		add_to_variable = { IBRIRMUDPopularity = 20 }
		add_popularity = {
			ideology = social_liberal
			popularity = 0.1	
		}
	
}

IBR_add_25_soclib = {
	#custom_effect_tooltip = IBR_add_25_soclib_tt
	 
		add_to_variable = { IBRIRMUDPopularity = 25 }
		add_popularity = {
			ideology = social_liberal
			popularity = 0.125
		}
	
}

IBR_add_30_soclib = {
	#custom_effect_tooltip = IBR_add_30_soclib_tt
	 
		add_to_variable = { IBRIRMUDPopularity = 30 }
		add_popularity = {
			ideology = social_liberal
			popularity = 0.15	
		}
	
}

IBR_add_random_soclib = {
	custom_effect_tooltip = IBR_add_random_soclib_tt
	hidden_effect = { 
		random_list = {
			25 = {
				add_to_variable = { IBRIRMUDPopularity = 2 }
				add_popularity = {
					ideology = social_liberal
					popularity = 0.005
				}
			}
			25 = {
				add_to_variable = { IBRIRMUDPopularity = 3 }
				add_popularity = {
					ideology = social_liberal
					popularity = 0.01	
				}
			}
			25 = {
				add_to_variable = { IBRIRMUDPopularity = 4 }
				add_popularity = {
					ideology = social_liberal
					popularity = 0.02	
				}
			}
			25 = {
				add_to_variable = { IBRIRMUDPopularity = 5 }
				add_popularity = {
					ideology = social_liberal
					popularity = 0.025
				}
			}
		}
	}
	
}
IBR_sub_3_soclib = {
	#custom_effect_tooltip = IBR_sub_3_soclib_tt
	 
		subtract_from_variable = { IBRIRMUDPopularity = 3 }
		add_popularity = {
			ideology = social_liberal
			popularity = -0.01
		}
		clamp_variable = {
			var = IBRIRMUDPopularity
			min = 0
			max = 10000
		}
	
}
IBR_sub_5_soclib = {	
	#custom_effect_tooltip = IBR_sub_5_soclib
	 
		subtract_from_variable = { IBRIRMUDPopularity = 5 }
		add_popularity = {
			ideology = social_liberal
			popularity = -0.025
		}
		clamp_variable = {
			var = IBRIRMUDPopularity
			min = 0
			max = 10000
		}
	
}
IBR_sub_10_soclib = {
	#custom_effect_tooltip = IBR_sub_10_soclib_tt
		subtract_from_variable = { IBRIRMUDPopularity = 10 }
		add_popularity = {
			ideology = social_liberal
			popularity = -0.05
		}
		clamp_variable = {
			var = IBRIRMUDPopularity
			min = 0
			max = 10000
		}
}
IBR_sub_15_soclib = {
	#custom_effect_tooltip = IBR_sub_15_soclib_tt
		subtract_from_variable = { IBRIRMUDPopularity = 15 }
		add_popularity = {
			ideology = social_liberal
			popularity = -0.075	
		}
		clamp_variable = {
			var = IBRIRMUDPopularity
			min = 0
			max = 10000
		}
}
IBR_sub_20_soclib = {
	#custom_effect_tooltip = IBR_sub_20_soclib_tt
		subtract_from_variable = { IBRIRMUDPopularity = 20 }
		add_popularity = {
			ideology = social_liberal
			popularity = -0.1	
		}
		clamp_variable = {
			var = IBRIRMUDPopularity
			min = 0
			max = 10000
		}
}

IBR_sub_25_soclib = {
	#custom_effect_tooltip = IBR_sub_25_soclib_tt
		subtract_from_variable = { IBRIRMUDPopularity = 25 }
		add_popularity = {
			ideology = social_liberal
			popularity = -0.125
		}
		clamp_variable = {
			var = IBRIRMUDPopularity
			min = 0
			max = 10000
		}
}

IBR_sub_30_soclib = {
	#custom_effect_tooltip = IBR_sub_30_soclib_tt
		subtract_from_variable = { IBRIRMUDPopularity = 30 }
		add_popularity = {
			ideology = social_liberal
			popularity = -0.15	
		}
		clamp_variable = {
			var = IBRIRMUDPopularity
			min = 0
			max = 10000
		}
}
IBR_sub_random_soclib = {
	custom_effect_tooltip = IBR_sub_random_soclib_tt
	hidden_effect = { 
		random_list = {
			20 = {
				subtract_from_variable = { IBRIRMUDPopularity = 1 }
				add_popularity = {
					ideology = social_liberal
					popularity = -0.01
				}
			}
			20 = {
				subtract_from_variable = { IBRIRMUDPopularity = 2 }
				add_popularity = {
					ideology = social_liberal
					popularity = -0.02
				}
			}
			20 = {
				subtract_from_variable = { IBRIRMUDPopularity = 3 }
				add_popularity = {
					ideology = social_liberal
					popularity = -0.03	
				}
			}
			20 = {
				subtract_from_variable = { IBRIRMUDPopularity = 4 }
				add_popularity = {
					ideology = social_liberal
					popularity = -0.04	
				}
			}
			20 = {
				subtract_from_variable = { IBRIRMUDPopularity = 5 }
				add_popularity = {
					ideology = social_liberal
					popularity = -0.05
				}
			}
		}
		clamp_variable = {
			var = IBRIRMUDPopularity
			min = 0
			max = 10000
		}
	}
}
IBR_election_tiebreaker = { 
if = {
		limit = { 
		check_variable = { IBRNationalUnionPopularity = IBRAlianzaPopularPopularity } 
		} 
		random_list = { 
			50 = { 
				add_to_variable = { IBRNationalUnionPopularity = 1 }
			} 
			50 = { 
				add_to_variable = { IBRAlianzaPopularPopularity = 1 }
			}
		}
	} 
else_if = {
		limit = { 
		check_variable = { IBRNationalUnionPopularity = IBRMarketLiberalPopularity } 
		} 
		random_list = { 
			50 = { 
				add_to_variable = { IBRNationalUnionPopularity = 1 }
			} 
			50 = { 
				add_to_variable = { IBRMarketLiberalPopularity = 1 }
			}
		}
	} 
else_if = {
		limit = { 
		check_variable = { IBRNationalUnionPopularity = IBRIRMUDPopularity } 
		} 
		random_list = { 
			50 = { 
				add_to_variable = { IBRNationalUnionPopularity = 1 }
			} 
			50 = { 
				add_to_variable = { IBRIRMUDPopularity = 1 }
			}
		}
	} 
else_if = {
		limit = { 
		check_variable = { IBRAlianzaPopularPopularity = IBRMarketLiberalPopularity } 
		} 
		random_list = { 
			50 = { 
				add_to_variable = { IBRMarketLiberalPopularity = 1 }
			} 
			50 = { 
				add_to_variable = { IBRAlianzaPopularPopularity = 1 }
			}
		}
	} 
else_if = {
		limit = { 
		check_variable = { IBRAlianzaPopularPopularity = IBRIRMUDPopularity } 
		} 
		random_list = { 
			50 = { 
				add_to_variable = { IBRIRMUDPopularity = 1 }
			} 
			50 = { 
				add_to_variable = { IBRAlianzaPopularPopularity = 1 }
			}
		}
	} 
else_if = {
		limit = { 
		check_variable = { IBRAlianzaPopularPopularity = IBRIzquierdaPopularity } 
		} 
		random_list = { 
			50 = { 
				add_to_variable = { IBRIzquierdaPopularity = 1 }
			} 
			50 = { 
				add_to_variable = { IBRAlianzaPopularPopularity = 1 }
			}
		}
	}
else_if = {
		limit = { 
		check_variable = { IBRMarketLiberalPopularity = IBRIRMUDPopularity } 
		} 
		random_list = { 
			50 = { 
				add_to_variable = { IBRMarketLiberalPopularity = 1 }
			} 
			50 = { 
				add_to_variable = { IBRIRMUDPopularity = 1 }
			}
		}
	} 
else_if = {
		limit = { 
		check_variable = { IBRMarketLiberalPopularity = IBRIzquierdaPopularity } 
		} 
		random_list = { 
			50 = { 
				add_to_variable = { IBRMarketLiberalPopularity = 1 }
			} 
			50 = { 
				add_to_variable = { IBRIzquierdaPopularity = 1 }
			}
		}
	} 
else_if = {
		limit = { 
		check_variable = { IBRIRMUDPopularity = IBRIzquierdaPopularity } 
		} 
		random_list = { 
			50 = { 
				add_to_variable = { IBRIRMUDPopularity = 1 }
			} 
			50 = { 
				add_to_variable = { IBRIzquierdaPopularity = 1 }
			}
		}
	}
}
###IBERIAN WARS

IBRCheckExhaustion = {
	#Add code here
	if = {
		limit = {
			check_variable = { IberianWarExhaustion > 95 }
			NOT = {
				has_country_flag = WarExEv5Fired
			}
		}
		country_event = {
			id = ibrwarexhaustion.5
			days = 1
		}
	}
	else_if = {
		limit = {
			check_variable = { IberianWarExhaustion > 80 }
			NOT = {
				has_country_flag = WarExEv4Fired
			}
		}
		country_event = {
			id = ibrwarexhaustion.4
			days = 1
		}
	}
	else_if = {
		limit = {
			check_variable = { IberianWarExhaustion > 60 }
			NOT = {
				has_country_flag = WarExEv3Fired
			}
		}
		country_event = {
			id = ibrwarexhaustion.3
			days = 1
		}
	}
	else_if = {
		limit = {
			check_variable = { IberianWarExhaustion > 40 }
			NOT = {
				has_country_flag = WarExEv2Fired
			}
		}
		country_event = {
			id = ibrwarexhaustion.2
			days = 1
		}
	}
	else_if = {
		limit = {
			check_variable = { IberianWarExhaustion > 20 }
			NOT = {
				has_country_flag = WarExEv1Fired
			}
		}
		country_event = {
			id = ibrwarexhaustion.1
			days = 1
		}
	}
}

IBRProcessExhaustionSpirit = {
	if = {
		limit = {
			check_variable = { IberianWarExhaustion > 95 }
		}
		add_ideas = Iberian_Wars_Exhaustion_5
		hidden_effect = {
			remove_ideas = Iberian_Wars_Exhaustion_4
			remove_ideas = Iberian_Wars_Exhaustion_3
			remove_ideas = Iberian_Wars_Exhaustion_2
			remove_ideas = Iberian_Wars_Exhaustion_1
			remove_ideas = Iberian_Wars_Minor
			remove_ideas = Iberian_Wars_Major
		}
	}
	else_if = {
		limit = {
			check_variable = { IberianWarExhaustion > 80 }
		}
		add_ideas = Iberian_Wars_Exhaustion_4
		hidden_effect = {
			remove_ideas = Iberian_Wars_Exhaustion_5
			remove_ideas = Iberian_Wars_Exhaustion_3
			remove_ideas = Iberian_Wars_Exhaustion_2
			remove_ideas = Iberian_Wars_Exhaustion_1
			remove_ideas = Iberian_Wars_Minor
			remove_ideas = Iberian_Wars_Major
		}
	}
	else_if = {
		limit = {
			check_variable = { IberianWarExhaustion > 60 }
		}
		add_ideas = Iberian_Wars_Exhaustion_3
		hidden_effect = {
			remove_ideas = Iberian_Wars_Exhaustion_5
			remove_ideas = Iberian_Wars_Exhaustion_4
			remove_ideas = Iberian_Wars_Exhaustion_2
			remove_ideas = Iberian_Wars_Exhaustion_1
			remove_ideas = Iberian_Wars_Minor
			remove_ideas = Iberian_Wars_Major
		}
	}
	else_if = {
		limit = {
			check_variable = { IberianWarExhaustion > 40 }
		}
		add_ideas = Iberian_Wars_Exhaustion_2
		hidden_effect = {
			remove_ideas = Iberian_Wars_Exhaustion_5
			remove_ideas = Iberian_Wars_Exhaustion_4
			remove_ideas = Iberian_Wars_Exhaustion_3
			remove_ideas = Iberian_Wars_Exhaustion_1
			remove_ideas = Iberian_Wars_Minor
			remove_ideas = Iberian_Wars_Major
		}
	}
	else_if = {
		limit = {
			check_variable = { IberianWarExhaustion > 20 }
		}
		add_ideas = Iberian_Wars_Exhaustion_1
		hidden_effect = {
			remove_ideas = Iberian_Wars_Exhaustion_5
			remove_ideas = Iberian_Wars_Exhaustion_4
			remove_ideas = Iberian_Wars_Exhaustion_3
			remove_ideas = Iberian_Wars_Exhaustion_2
			remove_ideas = Iberian_Wars_Minor
			remove_ideas = Iberian_Wars_Major
		}
	}
}

IBR_remove_all_ideas = { 
    remove_ideas = Iberian_Economic_Nightmare
			remove_ideas = Betray_Old_Guard
			remove_ideas = Crippled_Sovereignty
			remove_ideas = Crippled_Sovereignty_notsomuch
			remove_ideas = IBR_choose_carefully_idea
			remove_ideas = IBR_choose_carefully_2
			remove_ideas = IBR_distribute_excess_idea
			remove_ideas = IBR_liberalisation
			remove_ideas = Disorderly_Federal_Army
			remove_ideas = Disorderly_Federal_Army_2
			remove_ideas = Disorderly_Federal_Army_3
			remove_ideas = Disorderly_Federal_Army_Heydrich
			remove_ideas = Disorderly_Federal_Army_notsomuch
			remove_ideas = Expanded_Guardia_Civil
			remove_ideas = Formally_Decentralized_Army
			remove_ideas = Formally_Decentralized_Army_2
			remove_ideas = Formally_Decentralized_Army_3
			remove_ideas = Formally_Decentralized_Army_4
			remove_ideas = Separatist_Tensions
			remove_ideas = Separatist_Tensions_Goering
			remove_ideas = Weakened_Separatist_Tensions
			remove_ideas = Weakened_Separatist_Tensions_Goering
			remove_ideas = Unity_Against_External_Threat
}

IBRWarsAddPORclaims = {
	every_state = {
		limit = {
			is_portuguese_state = yes
		}
		PREV = {
			add_state_claim = PREV
		}
	}
}

IBRWarsAddMORclaims = { 
	MOR = {
		add_state_claim = 1005 
    	add_state_claim = 1150 
    	add_state_claim = 1152 
    	add_state_claim = 1153 
    	add_state_claim = 461 
    	add_state_claim = 462 
    	add_state_claim = 1008 
    	add_state_claim = 699 #Western Sahara 
    	add_state_claim = 1155 #Western Sahara 
    	add_state_claim = 1156 #Western Sahara 
    	add_state_claim = 1009 #Mauritania 
    	add_state_claim = 1157 #Mauritania  
    	add_state_claim = 1158 #Mauritania 
    	add_state_claim = 1010 #Mauritania  
    	add_state_claim = 1011 #Mauritania  
		add_state_claim = 839 #Trarza  
		add_state_claim = 1159 #Trarza  
	}
}
IBRWarsAddRIFclaims = { 
	RIF = { 
		add_state_claim = 1005 
		add_state_claim = 1150 
		add_state_claim = 1152 
		add_state_claim = 1153 
		add_state_claim = 461 
		add_state_claim = 462 
		add_state_claim = 1008 
		add_state_claim = 699 #Western Sahara 
	}
}
IBRWarsAddTRZclaims = { 
	TRZ = {  
		add_state_claim = 1009 #Mauritania 
		add_state_claim = 1157 #Mauritania  
		add_state_claim = 1158 #Mauritania 
		add_state_claim = 1010 #Mauritania  
		add_state_claim = 1011 #Mauritania  
		add_state_claim = 839 # Trarza  
	}
}
IBRWarsAddCTLclaims = { 
	CTL = { 
		add_state_claim = 165 
		add_state_claim = 986 
		add_state_claim = 1012 
		add_state_claim = 987 #Valencia  
		add_state_claim = 167 #Valencia
		add_state_claim = 177 #Baleares  
	}
}
IBRWarsAddCNTclaims = { 
	CNT = { 
		add_state_claim = 165 
		add_state_claim = 986 
		add_state_claim = 1012 
		add_state_claim = 987 #Valencia  
		add_state_claim = 167 #Valencia
		add_state_claim = 177 #Baleares  
	}
}
IBRWarsAddSPRclaims = { 
	SPR = {
		add_state_claim = 983 
		add_state_claim = 987 
		add_state_claim = 177 
		add_state_claim = 168 
		add_state_claim = 985 
		add_state_claim = 166 
		add_state_claim = 172 
		add_state_claim = 994 
		add_state_claim = 1013 
		add_state_claim = 41 
		add_state_claim = 1002 
		add_state_claim = 175 
		add_state_claim = 999 
		add_state_claim = 996 
		add_state_claim = 995 
		add_state_claim = 174 
		add_state_claim = 176 
		add_state_claim = 1001 
		add_state_claim = 170 
		add_state_claim = 169 
		add_state_claim = 173 
		add_state_claim = 988 
		add_state_claim = 1003 
		add_state_claim = 178 
		add_state_claim = 167
		add_state_claim = 178
	}
}
IBRWarsAddSPSclaims = { 
	every_state = {
		limit = {
			is_spanish_state = yes
		}
		PREV = {
			add_state_claim = PREV
		}
	}
}

IBRWarsAddIBRclaims = { 
	every_state = {
		limit = {
			OR = {
				is_spanish_state = yes
				is_portuguese_state = yes
			}
		}
		PREV = {
			add_state_claim = PREV
		}
	}
}

IBRWarsCheckPeace = {
	if = {
		limit = {
			POR = { united_portugal = yes }
		}
		POR = {
			country_event = { id = iberiawars.20 }
		}
	}
	if = {
		limit = {
			GNS = { united_portugal = yes }
		}
		GNS = { 
			country_event = {
				id = iberiawars.33
				days = 15
			}
		}
	}
	if = {
		limit = {
			GNS = { united_portugal = yes }
			all_state = {
				OR = {
					is_spanish_state = no
					THIS.owner = {
						OR = {
							is_subject_of = GNS
							tag = ITA
						}
					}
				}
			}
		}
		GNS = { 
			country_event = {
				id = iberiawars.23
			}
		}
	}
	if = {
		limit = {
			RPP = { united_portugal = yes }
		}
		RPP = {
			country_event = { id = iberiawars.21 }
		}
	}
	if = {
		limit = {
			PPR = { united_portugal = yes }
		}
		PPR = {
			country_event = { id = iberiawars.22 }
		}
	}
	if = {
		limit = {
			SPS = { united_spain = yes }
		}
		SPS = {
			country_event = { id = iberiawars.26 }
		}
	}
	if = {
		limit = {
			IBR = { united_portugal = yes }
			IBR = { united_spain = yes }
		}
		IBR = {
			country_event = { id = iberiawars.24 }
		}
	}
	if = {
		limit = {
			FSR = { united_portugal = yes }
			FSR = { united_spain = yes }
		}
		FSR = {
			country_event = { id = iberiawars.25 }
		}
	}
	if = {
		limit = {
			FZL = { united_spain = yes }
		}
		FZL = {
			country_event = {
				id = iberiawars.27
				days = 7
			}
		}
	}
	if = {
		limit = {
			FZL = { united_spain = yes }
			all_state = {
				OR = {
					is_portuguese_state = no
					THIS.owner = {
							is_subject_of = FZL
					}
				}
			}
		}
		FZL = { 
			country_event = { id = iberiawars.29 }
		}
	}
	if = {
		limit = {
			SPR = { exists = yes }
			IBR = { exists = no }
			SPS = { exists = no }
			FSR = { exists = no }
			FZL = { exists = no }
			TBA = { exists = no }
		}
		SPR = {
			country_event = {
				id = iberiawars.28
			}
		}
		every_country = {
			limit = {
				is_iberian_minor = yes
			}
			IBRWarsResign = yes
		}
	}
	if = {
		limit = {
			MOR = { exists = no }
		}
		TRZ = {
			IBRWarsResign = yes
		}
		RIF = {
			IBRWarsResign = yes
		}
	}
	if = {
		limit = {
			TRZ = { exists = no }
			RIF = { exists = no }
		}
		MOR = {
			IBRWarsResign = yes
		}
	}
}

IBRWarsGenerateTechStuff = {
	BSQ = {	
		inherit_technology = IBR 
		add_manpower = 15000
	}
	PRT = {	
		inherit_technology = IBR 
	}
	SPS = {	inherit_technology = IBR
	}
	SPA = {	inherit_technology = IBR
	}
	CTL = {	inherit_technology = IBR
	}
	CNT = {	inherit_technology = IBR
	}
	GAL = {	inherit_technology = IBR
	}
	MOR = {	inherit_technology = IBR
	}
	ETA = {	inherit_technology = IBR
	}
	FML = {	inherit_technology = IBR
	}
	GIB = {	inherit_technology = IBR
	}
	FSR = {	inherit_technology = IBR
	}
	GNS = {	inherit_technology = IBR
	}
	PPR = {	inherit_technology = IBR
	}
	RPP = {	inherit_technology = IBR
	}
	TBA = {	inherit_technology = IBR
	}
	RIF = {	inherit_technology = IBR
	}
	MAU = {	inherit_technology = IBR
	}
	KBY = {	inherit_technology = IBR
	}
	SPR = {	inherit_technology = IBR
	}
	POR = {	inherit_technology = IBR
	}
	IBR = {
		add_offsite_building = {
				type = arms_factory
				level = 2
			}
	}
	SPS = {
		add_offsite_building = {
				type = arms_factory
				level = 2
			}
			995 = { 
				add_building_construction = {
					type = air_base
					level = 1
					instant_build = yes
				}
			}
	}
	TBA = {
		add_offsite_building = {
				type = arms_factory
				level = 2
			}
			983 = { 
				add_building_construction = {
					type = air_base
					level = 1
					instant_build = yes
				}
			}
	}
	SPR = {
		add_offsite_building = {
				type = arms_factory
				level = 2
			}
		169 = { 
			add_building_construction = {
				type = air_base
				level = 1
				instant_build = yes
			}
		}
	}
	FSR = {
		add_offsite_building = {
				type = arms_factory
				level = 2
			}
	}
	BSQ = {
		add_offsite_building = {
				type = arms_factory
				level = 2
			}
			984 = { 
				add_building_construction = {
					type = air_base
					level = 1
					instant_build = yes
				}
			}
			993 = { 
				add_building_construction = {
					type = air_base
					level = 1
					instant_build = yes
				}
			}
	}
	ETA = {
		add_offsite_building = {
				type = arms_factory
				level = 2
			}
	}
	CNT = {
		add_offsite_building = {
				type = arms_factory
				level = 2
			}
	}
	CTL = {
		add_offsite_building = {
				type = arms_factory
				level = 2
			}
			986 = { 
				add_building_construction = {
					type = air_base
					level = 1
					instant_build = yes
				}
			}
			165 = { 
				add_building_construction = {
					type = air_base
					level = 1
					instant_build = yes
				}
			}
	}
	GAL = {
		add_offsite_building = {
				type = arms_factory
				level = 2
			}
	}
	POR = {
		add_offsite_building = {
				type = arms_factory
				level = 2
			}
			180 = { 
				add_building_construction = {
					type = air_base
					level = 1
					instant_build = yes
				}
			}
			179 = { 
				add_building_construction = {
					type = air_base
					level = 1
					instant_build = yes
				}
			}
			1000 = { 
				add_building_construction = {
					type = air_base
					level = 1
					instant_build = yes
				}
			}
	}
	PRT = {
		add_offsite_building = {
				type = arms_factory
				level = 2
			}
	}
	PPR = {
		add_offsite_building = {
				type = arms_factory
				level = 2
			}
	}
	RPP = {
		add_offsite_building = {
				type = arms_factory
				level = 2
			}
	}
	GNS = {
		add_offsite_building = {
				type = arms_factory
				level = 2
			}
	}
	MOR = {
		add_offsite_building = {
				type = arms_factory
				level = 2
			}
	}
	TRZ = {
		add_offsite_building = {
				type = arms_factory
				level = 2
			}
	}
	ALG = {
		add_offsite_building = {
				type = arms_factory
				level = 2
			}
	}
	KBY = {
		add_offsite_building = {
				type = arms_factory
				level = 2
			}
	}
	RIF = {
		add_offsite_building = {
				type = arms_factory
				level = 2
			}
	}
	FML = {
		add_offsite_building = {
				type = arms_factory
				level = 2
			}
	}
}

IBRWarsResign = {
	remove_ideas = Iberian_Wars_Minor
	remove_ideas = Iberian_Wars_Major
	remove_ideas = Iberian_Wars_Exhaustion_1
	remove_ideas = Iberian_Wars_Exhaustion_2
	remove_ideas = Iberian_Wars_Exhaustion_3
	remove_ideas = Iberian_Wars_Exhaustion_4
	remove_ideas = Iberian_Wars_Exhaustion_5
	set_country_flag = Iberian_Wars_Resigned
	set_variable = {IberianWarExhaustion = 0}
}

IBRWarsAssignCosmetic = {
	if = {
		limit = {
			is_puppet_of = POR
		}
		set_cosmetic_tag = POR_GOVERNATE
	}
	if = {
		limit = {
			is_puppet_of = GNS
		}
		set_cosmetic_tag = GNS_GOVERNATE
	}
	if = {
		limit = {
			is_puppet_of = SPA
		}
		set_cosmetic_tag = SPA_GOVERNATE
	}
	if = {
		limit = {
			is_puppet_of = SPR
		}
		set_cosmetic_tag = SPR_GOVERNATE
	}
	if = {
		limit = {
			is_puppet_of = SPS
		}
		set_cosmetic_tag = SPS_GOVERNATE
	}
	if = {
		limit = {
			is_puppet_of = PPR
		}
		set_cosmetic_tag = PPR_GOVERNATE
	}
	if = {
		limit = {
			is_puppet_of = RPP
		}
		set_cosmetic_tag = RPP_GOVERNATE
	}
	if = {
		limit = {
			is_puppet_of = TBA
		}
		set_cosmetic_tag = TBA_GOVERNATE
	}
	if = {
		limit = {
			is_puppet_of = BSQ
		}
		set_cosmetic_tag = BSQ_GOVERNATE
	}
	if = {
		limit = {
			is_puppet_of = CTL
		}
		set_cosmetic_tag = CTL_GOVERNATE
	}
	if = {
		limit = {
			is_puppet_of = CNT
		}
		set_cosmetic_tag = CNT_GOVERNATE
	}
}

Form_iberian_RKs = {
	SPS = { set_cosmetic_tag = SPS_RK }
		SPA = { set_cosmetic_tag = SPA_RK }
		CTL = { set_cosmetic_tag = CTL_RK }
		BSQ = { set_cosmetic_tag = BSQ_RK }
		GAL = { set_cosmetic_tag = GAL_RK }
		MOR = { set_cosmetic_tag = MOR_RK }
		POR = { set_cosmetic_tag = POR_RK }
		CTL = {
			set_politics = {
				ruling_party = national_socialism
			}
			transfer_state = 167
			transfer_state = 166
			transfer_state = 985
			transfer_state = 165
			transfer_state = 986
			transfer_state = 1012
			transfer_state = 987
		}
		BSQ = {
			set_politics = {
				ruling_party = national_socialism
			}
			transfer_state = 984
			transfer_state = 993
			transfer_state = 172
		}
		GAL = {
			set_politics = {
				ruling_party = national_socialism
			}
			transfer_state = 982
			transfer_state = 171
		}
		SPA = {
			set_politics = {
				ruling_party = national_socialism
			}
			transfer_state = 170
			transfer_state = 1001
			transfer_state = 169
			transfer_state = 173
			transfer_state = 1003
			transfer_state = 168
			transfer_state = 1002
			transfer_state = 988
		}
		SPS = {
			set_politics = {
				ruling_party = national_socialism
			}
			transfer_state = 983
			transfer_state = 174
			transfer_state = 996
			transfer_state = 41
			transfer_state = 995
			transfer_state = 1013
			transfer_state = 175
			transfer_state = 999
			transfer_state = 176
			transfer_state = 994
		}
		POR = {
			set_politics = {
				ruling_party = national_socialism
			}
			transfer_state = 180
			transfer_state = 997
			transfer_state = 181
			transfer_state = 998
			transfer_state = 112
			transfer_state = 1000
			transfer_state = 179
			transfer_state = 1004
		}
		MOR = {
			set_politics = {
				ruling_party = national_socialism
			}
			transfer_state = 1007
			transfer_state = 513
			transfer_state = 459
			transfer_state = 1006
			transfer_state = 1151
			transfer_state = 1147
			transfer_state = 1154
			transfer_state = 1005
			transfer_state = 1150
			transfer_state = 1152
			transfer_state = 461
			transfer_state = 1153
			transfer_state = 462
			transfer_state = 699
			transfer_state = 1009
			transfer_state = 1155
			transfer_state = 1156
			transfer_state = 1010
			transfer_state = 1011
			transfer_state = 1158
			transfer_state = 1157
		}
		GER = {
			transfer_state = 118
			transfer_state = 290
			transfer_state = 1008
		}
} 
IBR_divorce_generals = { 
every_unit_leader = {
            limit = { has_id = 1301 }
            set_nationality = SPA

        }
every_unit_leader = {
            limit = { has_id = 1302 }
            set_nationality = SPA

        }
every_unit_leader = {
            limit = { has_id = 1303 }
            set_nationality = SPA

        }
every_unit_leader = {
            limit = { has_id = 1304 }
            set_nationality = SPA

        }
every_unit_leader = {
            limit = { has_id = 1305 }
            set_nationality = SPA

        }
every_unit_leader = {
            limit = { has_id = 1306 }
            set_nationality = POR

        }
every_unit_leader = {
            limit = { has_id = 1307 }
            set_nationality = POR

        }
every_unit_leader = {
            limit = { has_id = 1308 }
            set_nationality = SPA

        }
every_unit_leader = {
            limit = { has_id = 1309 }
            set_nationality = POR

        }
every_unit_leader = {
            limit = { has_id = 1312 }
            set_nationality = SPA

        }
every_unit_leader = {
            limit = { has_id = 1317 }
            set_nationality = SPA

        }
every_unit_leader = {
            limit = { has_id = 1319 }
            set_nationality = SPA

        }
every_unit_leader = {
            limit = { has_id = 1310 }
            set_nationality = SPA

        }
every_unit_leader = {
            limit = { has_id = 1311 }
            set_nationality = SPA

        }
every_unit_leader = {
            limit = { has_id = 1313 }
            set_nationality = SPA

        }
every_unit_leader = {
            limit = { has_id = 1314 }
            set_nationality = POR

        }
every_unit_leader = {
            limit = { has_id = 1315 }
            set_nationality = POR

        }
every_unit_leader = {
            limit = { has_id = 1316 }
            set_nationality = SPA

        }
every_unit_leader = {
            limit = { has_id = 1318 }
            set_nationality = SPA

        }
}
IBR_improve_military_opinion = { 
	if = { 
		limit = { 
			has_country_leader = {
				name = "Francisco Franco"
			}
		}
		add_to_variable = {IBR_military_alignment = 2}
		clamp_variable = {
			var = IBR_military_alignment
			min = -20
			max = 20
		}
		custom_effect_tooltip = IBR_improve_franco_army_tt
		IBR_check_caudillo_popularity = yes
	}
	else_if = { 
		limit = { 
			OR = { 
				has_country_flag = cau_weak_salazar
				has_country_flag = cau_strong_salazar
			}
		}
		add_to_variable = {IBR_military_alignment = -2}
		clamp_variable = {
			var = IBR_military_alignment
			min = -20
			max = 20
		}
		custom_effect_tooltip = IBR_improve_salazar_army_tt
		IBR_check_caudillo_popularity = yes
	}
	else = {
		hidden_effect = {
		random_list = {
			
		50 = {
			add_to_variable = {IBR_military_alignment = 2}
			custom_effect_tooltip = IBR_improve_franco_army_tt
			clamp_variable = {
				var = IBR_military_alignment
				min = -20
				max = 20
			}
			IBR_check_caudillo_popularity = yes	
		}
				
		50 = {
			add_to_variable = {IBR_military_alignment = -2}
			custom_effect_tooltip = IBR_improve_salazar_army_tt
			clamp_variable = {
				var = IBR_military_alignment
				min = -20
				max = 20
			}
			IBR_check_caudillo_popularity = yes	
		}
		}
		}
	}
}
IBR_improve_church_opinion = { 
	if = { 
		limit = { 
			has_country_leader = {
				name = "Francisco Franco"
			}
		}
		add_to_variable = {IBR_church_alignment = 2}
		clamp_variable = {
			var = IBR_church_alignment
			min = -20
			max = 20
		}
		custom_effect_tooltip = IBR_improve_franco_church_tt
		IBR_check_caudillo_popularity = yes
	}
	else_if = { 
		limit = { 
			OR = { 
				has_country_flag = cau_weak_salazar
				has_country_flag = cau_strong_salazar
			}
		}
		add_to_variable = {IBR_church_alignment = -2}
		clamp_variable = {
			var = IBR_church_alignment
			min = -20
			max = 20
		}
		custom_effect_tooltip = IBR_improve_salazar_church_tt
		IBR_check_caudillo_popularity = yes
	}
	else = {
		hidden_effect = {
		random_list = {
			
		50 = {
			add_to_variable = {IBR_church_alignment = 2}
			clamp_variable = {
				var = IBR_church_alignment
				min = -20
				max = 20
			}
			custom_effect_tooltip = IBR_improve_franco_church_tt
			IBR_check_caudillo_popularity = yes	
		}
				
		50 = {
			add_to_variable = {IBR_church_alignment = -2}
			clamp_variable = {
				var = IBR_church_alignment
				min = -20
				max = 20
			}
			custom_effect_tooltip = IBR_improve_salazar_church_tt
			IBR_check_caudillo_popularity = yes	
		}
		}
		}
	}
	
}
IBR_improve_burocrats_opinion = { 
	if = { 
		limit = { 
			has_country_leader = {
				name = "Francisco Franco"
			}
		}
		add_to_variable = {IBR_burocrat_alignment = 1}
		clamp_variable = {
			var = IBR_burocrat_alignment
			min = -10
			max = 10
		}
		custom_effect_tooltip = IBR_improve_franco_bureaucrats_tt
		IBR_check_caudillo_popularity = yes
	}
	else_if = { 
		limit = { 
			OR = { 
				has_country_flag = cau_weak_salazar
				has_country_flag = cau_strong_salazar
			}
		}
		add_to_variable = {IBR_burocrat_alignment = -1}
		clamp_variable = {
			var = IBR_burocrat_alignment
			min = -10
			max = 10
		}
		custom_effect_tooltip = IBR_improve_salazar_bureaucrats_tt
		IBR_check_caudillo_popularity = yes
	}
	else = {
		hidden_effect = {
		random_list = {
			
		50 = {
			add_to_variable = {IBR_burocrat_alignment = 1}
			clamp_variable = {
				var = IBR_burocrat_alignment
				min = -10
				max = 10
			}
			custom_effect_tooltip = IBR_improve_franco_bureaucrats_tt
			IBR_check_caudillo_popularity = yes	
		}
				
		50 = {
			add_to_variable = {IBR_burocrat_alignment = -1}
			clamp_variable = {
				var = IBR_burocrat_alignment
				min = -10
				max = 10
			}
			custom_effect_tooltip = IBR_improve_salazar_bureaucrats_tt
			IBR_check_caudillo_popularity = yes	
		}
		}
		}
	}
}
IBR_improve_business_opinion = { 
	if = { 
		limit = { 
			has_country_leader = {
				name = "Francisco Franco"
			}
		}
		add_to_variable = {IBR_business_alignment = 1.5}
		clamp_variable = {
			var = IBR_business_alignment
			min = -15
			max = 15
		}
		custom_effect_tooltip = IBR_improve_franco_businessmen_tt
		IBR_check_caudillo_popularity = yes
	}
	else_if = { 
		limit = { 
			OR = { 
				has_country_flag = cau_weak_salazar
				has_country_flag = cau_strong_salazar
			}
		}
		add_to_variable = {IBR_business_alignment = -1.5}
		clamp_variable = {
			var = IBR_business_alignment
			min = -15
			max = 15
		}
		custom_effect_tooltip = IBR_improve_salazar_businessmen_tt
		IBR_check_caudillo_popularity = yes
	}
	else = {
		hidden_effect = {
		random_list = {
			
		50 = {
			add_to_variable = {IBR_business_alignment = 1.5}
			clamp_variable = {
				var = IBR_business_alignment
				min = -15
				max = 15
			}
			custom_effect_tooltip = IBR_improve_franco_businessmen_tt
			IBR_check_caudillo_popularity = yes	
		}
				
		50 = {
			add_to_variable = {IBR_business_alignment = -1.5}
			clamp_variable = {
				var = IBR_business_alignment
				min = -15
				max = 15
			}
			custom_effect_tooltip = IBR_improve_salazar_businessmen_tt
			IBR_check_caudillo_popularity = yes	
		}
		}
		}
	}
}
IBR_improve_settlers_opinion = { 
	if = { 
		limit = { 
			has_country_leader = {
				name = "Francisco Franco"
			}
		}
		add_to_variable = {IBR_settlers_alignment = 1}
		clamp_variable = {
			var = IBR_settlers_alignment
			min = -10
			max = 10
		}
		custom_effect_tooltip = IBR_improve_franco_settlers_tt
		IBR_check_caudillo_popularity = yes
	}
	else_if = { 
		limit = { 
			OR = { 
				has_country_flag = cau_weak_salazar
				has_country_flag = cau_strong_salazar
			}
		}
		add_to_variable = {IBR_settlers_alignment = -1}
		clamp_variable = {
			var = IBR_settlers_alignment
			min = -10
			max = 10
		}
		custom_effect_tooltip = IBR_improve_salazar_settlers_tt
		IBR_check_caudillo_popularity = yes
	}
	else = {
		hidden_effect = {
		random_list = {
			
		50 = {
			add_to_variable = {IBR_settlers_alignment = 1}
			clamp_variable = {
				var = IBR_settlers_alignment
				min = -10
				max = 10
			}
			custom_effect_tooltip = IBR_improve_franco_settlers_tt
			IBR_check_caudillo_popularity = yes	
		}
				
		50 = {
			add_to_variable = {IBR_settlers_alignment = -1}
			clamp_variable = {
				var = IBR_settlers_alignment
				min = -10
				max = 10
			}
			custom_effect_tooltip = IBR_improve_salazar_settlers_tt
			IBR_check_caudillo_popularity = yes	
		}
		}
		}
	}
}
IBR_improve_native_opinion = { 
	if = { 
		limit = { 
			has_country_leader = {
				name = "Francisco Franco"
			}
		}
		add_to_variable = {IBR_native_alignment = 1}
		clamp_variable = {
			var = IBR_native_alignment
			min = -10
			max = 10
		}
		custom_effect_tooltip = IBR_improve_franco_natives_tt
		IBR_check_caudillo_popularity = yes
	}
	else_if = { 
		limit = { 
			OR = { 
				has_country_flag = cau_weak_salazar
				has_country_flag = cau_strong_salazar
			}
		}
		add_to_variable = {IBR_native_alignment = -1}
		clamp_variable = {
			var = IBR_native_alignment
			min = -10
			max = 10
		}
		custom_effect_tooltip = IBR_improve_salazar_natives_tt
		IBR_check_caudillo_popularity = yes
	}
	else = {
		hidden_effect = {
		random_list = {
			
		50 = {
			add_to_variable = {IBR_native_alignment = 1}
			clamp_variable = {
				var = IBR_native_alignment
				min = -10
				max = 10
			}
			custom_effect_tooltip = IBR_improve_franco_natives_tt
			IBR_check_caudillo_popularity = yes	
		}
				
		50 = {
			add_to_variable = {IBR_native_alignment = -1}
			clamp_variable = {
				var = IBR_native_alignment
				min = -10
				max = 10
			}
			custom_effect_tooltip = IBR_improve_salazar_natives_tt
			IBR_check_caudillo_popularity = yes	
		}
		}
		}
	}
}
IBR_improve_foreign_opinion = { 
	if = { 
		limit = { 
			has_country_leader = {
				name = "Francisco Franco"
			}
		}
		add_to_variable = {IBR_foreign_alignment = 1.5}
		clamp_variable = {
			var = IBR_foreign_alignment
			min = -15
			max = 15
		}
		custom_effect_tooltip = IBR_improve_franco_foreign_tt
		IBR_check_caudillo_popularity = yes
	}
	else_if = { 
		limit = { 
			OR = { 
				has_country_flag = cau_weak_salazar
				has_country_flag = cau_strong_salazar
			}
		}
		add_to_variable = {IBR_foreign_alignment = -1.5}
		clamp_variable = {
			var = IBR_foreign_alignment
			min = -15
			max = 15
		}
		custom_effect_tooltip = IBR_improve_salazar_foreign_tt
		IBR_check_caudillo_popularity = yes
	}
	else = {
		hidden_effect = {
		random_list = {
			
		50 = {
			add_to_variable = {IBR_foreign_alignment = 1.5}
			clamp_variable = {
				var = IBR_foreign_alignment
				min = -15
				max = 15
			}
			custom_effect_tooltip = IBR_improve_franco_foreign_tt
			IBR_check_caudillo_popularity = yes	
		}
				
		50 = {
			add_to_variable = {IBR_foreign_alignment = -1.5}
			clamp_variable = {
				var = IBR_foreign_alignment
				min = -15
				max = 15
			}
			custom_effect_tooltip = IBR_improve_salazar_foreign_tt
			IBR_check_caudillo_popularity = yes	
		}
		}
		}
	}
}
IBR_improve_intellectual_opinion = { 
	if = { 
		limit = { 
			has_country_leader = {
				name = "Francisco Franco"
			}
		}
		add_to_variable = {IBR_intellectual_alignment = 1.5}
		clamp_variable = {
			var = IBR_intellectual_alignment
			min = -15
			max = 15
		}
		custom_effect_tooltip = IBR_improve_franco_intellectuals_tt
		IBR_check_caudillo_popularity = yes
	}
	else_if = { 
		limit = { 
			OR = { 
				has_country_flag = cau_weak_salazar
				has_country_flag = cau_strong_salazar
			}
		}
		add_to_variable = {IBR_intellectual_alignment = -1.5}
		clamp_variable = {
			var = IBR_intellectual_alignment
			min = -15
			max = 15
		}
		custom_effect_tooltip = IBR_improve_salazar_intellectuals_tt
		IBR_check_caudillo_popularity = yes
	}
	else = {
		hidden_effect = {
		random_list = {
			
		50 = {
			add_to_variable = {IBR_intellectual_alignment = 1.5}
			clamp_variable = {
				var = IBR_intellectual_alignment
				min = -15
				max = 15
			}
			custom_effect_tooltip = IBR_improve_franco_intellectuals_tt
			IBR_check_caudillo_popularity = yes	
		}
				
		50 = {
			add_to_variable = {IBR_intellectual_alignment = -1.5}
			clamp_variable = {
				var = IBR_intellectual_alignment
				min = -15
				max = 15
			}
			custom_effect_tooltip = IBR_improve_salazar_intellectuals_tt
			IBR_check_caudillo_popularity = yes	
		}
		}
		}
	}
}
IBR_improve_majority_opinion = { 
	if = { 
		limit = { 
			has_country_leader = {
				name = "Francisco Franco"
			}
		}
		add_to_variable = {IBR_majority_alignment = 1}
		clamp_variable = {
			var = IBR_majority_alignment
			min = -10
			max = 10
		}
		custom_effect_tooltip = IBR_improve_franco_majority_tt
		IBR_check_caudillo_popularity = yes
	}
	else_if = { 
		limit = { 
			OR = { 
				has_country_flag = cau_weak_salazar
				has_country_flag = cau_strong_salazar
			}
		}
		add_to_variable = {IBR_majority_alignment = -1}
		clamp_variable = {
			var = IBR_majority_alignment
			min = -10
			max = 10
		}
		custom_effect_tooltip = IBR_improve_salazar_majority_tt
		IBR_check_caudillo_popularity = yes
	}
	else = {
		hidden_effect = {
		random_list = {
			
		50 = {
			add_to_variable = {IBR_majority_alignment = 1}
			clamp_variable = {
				var = IBR_majority_alignment
				min = -10
				max = 10
			}
			custom_effect_tooltip = IBR_improve_franco_majority_tt
			IBR_check_caudillo_popularity = yes	
		}
				
		50 = {
			add_to_variable = {IBR_majority_alignment = -1}
			clamp_variable = {
				var = IBR_majority_alignment
				min = -10
				max = 10
			}
			custom_effect_tooltip = IBR_improve_salazar_majority_tt
			IBR_check_caudillo_popularity = yes	
		}
		}
		}
	}
}
IBR_improve_regional_opinion = { 
	if = { 
		limit = { 
			has_country_leader = {
				name = "Francisco Franco"
			}
		}
		add_to_variable = {IBR_regional_alignment = 1}
		clamp_variable = {
			var = IBR_regional_alignment
			min = -10
			max = 10
		}
		custom_effect_tooltip = IBR_improve_franco_regional_tt
		IBR_check_caudillo_popularity = yes
	}
	else_if = { 
		limit = { 
			OR = { 
				has_country_flag = cau_weak_salazar
				has_country_flag = cau_strong_salazar
			}
		}
		add_to_variable = {IBR_regional_alignment = -1}
		clamp_variable = {
			var = IBR_regional_alignment
			min = -10
			max = 10
		}
		custom_effect_tooltip = IBR_improve_salazar_regional_tt
		IBR_check_caudillo_popularity = yes
	}
	else = {
		hidden_effect = {
		random_list = {
			
		50 = {
			add_to_variable = {IBR_regional_alignment = 1}
			clamp_variable = {
				var = IBR_regional_alignment
				min = -10
				max = 10
			}
			custom_effect_tooltip = IBR_improve_franco_regional_tt
			IBR_check_caudillo_popularity = yes	
		}
				
		50 = {
			add_to_variable = {IBR_regional_alignment = -1}
			clamp_variable = {
				var = IBR_regional_alignment
				min = -10
				max = 10
			}
			custom_effect_tooltip = IBR_improve_salazar_regional_tt
			IBR_check_caudillo_popularity = yes	
		}
		}
		}
	}
}
IBR_worsen_military_opinion = { 
	if = { 
		limit = { 
			has_country_leader = {
				name = "Francisco Franco"
			}
		}
		add_to_variable = {IBR_military_alignment = -2}
		custom_effect_tooltip = IBR_worsen_franco_army_tt
		clamp_variable = {
			var = IBR_military_alignment
			min = -20
			max = 20
		}
		IBR_check_caudillo_popularity = yes
	}
	else_if = { 
		limit = { 
			OR = { 
				has_country_flag = cau_weak_salazar
				has_country_flag = cau_strong_salazar
			}
		}
		add_to_variable = {IBR_military_alignment = 2}
		custom_effect_tooltip = IBR_worsen_salazar_army_tt
		clamp_variable = {
			var = IBR_military_alignment
			min = -20
			max = 20
		}
		IBR_check_caudillo_popularity = yes
	}
	else = {
		hidden_effect = {
		random_list = {
			
		50 = {
			add_to_variable = {IBR_military_alignment = -2}
			custom_effect_tooltip = IBR_worsen_franco_army_tt
			clamp_variable = {
				var = IBR_military_alignment
				min = -20
				max = 20
			}
			IBR_check_caudillo_popularity = yes	
		}
				
		50 = {
			add_to_variable = {IBR_military_alignment = 2}
			custom_effect_tooltip = IBR_worsen_salazar_army_tt
			clamp_variable = {
				var = IBR_military_alignment
				min = -20
				max = 20
			}
			IBR_check_caudillo_popularity = yes	
		}
		}
		}
	}
}
IBR_worsen_church_opinion = { 
	if = { 
		limit = { 
			has_country_leader = {
				name = "Francisco Franco"
			}
		}
		add_to_variable = {IBR_church_alignment = -2}
		clamp_variable = {
			var = IBR_church_alignment
			min = -20
			max = 20
		}
		custom_effect_tooltip = IBR_worsen_franco_church_tt
		IBR_check_caudillo_popularity = yes
	}
	else_if = { 
		limit = { 
			OR = { 
				has_country_flag = cau_weak_salazar
				has_country_flag = cau_strong_salazar
			}
		}
		add_to_variable = {IBR_church_alignment = 2}
		clamp_variable = {
			var = IBR_church_alignment
			min = -20
			max = 20
		}
		custom_effect_tooltip = IBR_worsen_salazar_church_tt
		IBR_check_caudillo_popularity = yes
	}
	else = {
		hidden_effect = {
		random_list = {
			
		50 = {
			add_to_variable = {IBR_church_alignment = -2}
			clamp_variable = {
				var = IBR_church_alignment
				min = -20
				max = 20
			}
			custom_effect_tooltip = IBR_worsen_franco_church_tt
			IBR_check_caudillo_popularity = yes	
		}
				
		50 = {
			add_to_variable = {IBR_church_alignment = 2}
			clamp_variable = {
				var = IBR_church_alignment
				min = -20
				max = 20
			}
			custom_effect_tooltip = IBR_worsen_salazar_church_tt
			IBR_check_caudillo_popularity = yes	
		}
		}
		}
	}
}
IBR_worsen_burocrats_opinion = { 
	if = { 
		limit = { 
			has_country_leader = {
				name = "Francisco Franco"
			}
		}
		add_to_variable = {IBR_burocrat_alignment = -1.5}
		clamp_variable = {
			var = IBR_burocrat_alignment
			min = -10
			max = 10
		}
		custom_effect_tooltip = IBR_worsen_franco_bureaucrats_tt
		IBR_check_caudillo_popularity = yes
	}
	else_if = { 
		limit = { 
			OR = { 
				has_country_flag = cau_weak_salazar
				has_country_flag = cau_strong_salazar
			}
		}
		add_to_variable = {IBR_burocrat_alignment = 1.5}
		clamp_variable = {
			var = IBR_burocrat_alignment
			min = -10
			max = 10
		}
		custom_effect_tooltip = IBR_worsen_salazar_bureaucrats_tt
		IBR_check_caudillo_popularity = yes
	}
	else = {
		hidden_effect = {
		random_list = {
			
		50 = {
			add_to_variable = {IBR_burocrat_alignment = -1.5}
			clamp_variable = {
				var = IBR_burocrat_alignment
				min = -10
				max = 10
			}
			custom_effect_tooltip = IBR_worsen_franco_bureaucrats_tt
			IBR_check_caudillo_popularity = yes	
		}
				
		50 = {
			add_to_variable = {IBR_burocrat_alignment = 1.5}
			clamp_variable = {
				var = IBR_burocrat_alignment
				min = -10
				max = 10
			}
			custom_effect_tooltip = IBR_worsen_salazar_bureaucrats_tt
			IBR_check_caudillo_popularity = yes	
		}
		}
		}
	}
}
IBR_worsen_business_opinion = { 
	if = { 
		limit = { 
			has_country_leader = {
				name = "Francisco Franco"
			}
		}
		add_to_variable = {IBR_business_alignment = -1.5}
		clamp_variable = {
			var = IBR_business_alignment
			min = -15
			max = 15
		}
		custom_effect_tooltip = IBR_worsen_franco_businessmen_tt
		IBR_check_caudillo_popularity = yes
	}
	else_if = { 
		limit = { 
			OR = { 
				has_country_flag = cau_weak_salazar
				has_country_flag = cau_strong_salazar
			}
		}
		add_to_variable = {IBR_business_alignment = 1.5}
		clamp_variable = {
			var = IBR_business_alignment
			min = -15
			max = 15
		}
		custom_effect_tooltip = IBR_worsen_salazar_businessmen_tt
		IBR_check_caudillo_popularity = yes
	}
	else = {
		hidden_effect = {
		random_list = {
			
		50 = {
			add_to_variable = {IBR_business_alignment = -1.5}
			clamp_variable = {
				var = IBR_business_alignment
				min = -15
				max = 15
			}
			custom_effect_tooltip = IBR_worsen_franco_businessmen_tt
			IBR_check_caudillo_popularity = yes	
		}
				
		50 = {
			add_to_variable = {IBR_business_alignment = 1.5}
			clamp_variable = {
				var = IBR_business_alignment
				min = -15
				max = 15
			}
			custom_effect_tooltip = IBR_worsen_salazar_businessmen_tt
			IBR_check_caudillo_popularity = yes	
		}
		}
		}
	}
}
IBR_worsen_settlers_opinion = { 
	if = { 
		limit = { 
			has_country_leader = {
				name = "Francisco Franco"
			}
		}
		add_to_variable = {IBR_settlers_alignment = -1}
		clamp_variable = {
			var = IBR_settlers_alignment
			min = -10
			max = 10
		}
		custom_effect_tooltip = IBR_worsen_franco_settlers_tt
		IBR_check_caudillo_popularity = yes
	}
	else_if = { 
		limit = { 
			OR = { 
				has_country_flag = cau_weak_salazar
				has_country_flag = cau_strong_salazar
			}
		}
		add_to_variable = {IBR_settlers_alignment = 1}
		clamp_variable = {
			var = IBR_settlers_alignment
			min = -10
			max = 10
		}
		custom_effect_tooltip = IBR_worsen_salazar_settlers_tt
		IBR_check_caudillo_popularity = yes
	}
	else = {
		hidden_effect = {
		random_list = {
			
		50 = {
			add_to_variable = {IBR_settlers_alignment = -1}
			clamp_variable = {
				var = IBR_settlers_alignment
				min = -10
				max = 10
			}
			custom_effect_tooltip = IBR_worsen_franco_settlers_tt
			IBR_check_caudillo_popularity = yes	
		}
				
		50 = {
			add_to_variable = {IBR_settlers_alignment = 1}
			clamp_variable = {
				var = IBR_settlers_alignment
				min = -10
				max = 10
			}
			custom_effect_tooltip = IBR_worsen_salazar_settlers_tt
			IBR_check_caudillo_popularity = yes	
		}
		}
		}
	}
}
IBR_worsen_native_opinion = { 
	if = { 
		limit = { 
			has_country_leader = {
				name = "Francisco Franco"
			}
		}
		add_to_variable = {IBR_native_alignment = -1}
		clamp_variable = {
			var = IBR_native_alignment
			min = -10
			max = 10
		}
		custom_effect_tooltip = IBR_worsen_franco_natives_tt
		IBR_check_caudillo_popularity = yes
	}
	else_if = { 
		limit = { 
			OR = { 
				has_country_flag = cau_weak_salazar
				has_country_flag = cau_strong_salazar
			}
		}
		add_to_variable = {IBR_native_alignment = 1}
		clamp_variable = {
			var = IBR_native_alignment
			min = -10
			max = 10
		}
		custom_effect_tooltip = IBR_worsen_salazar_natives_tt
		IBR_check_caudillo_popularity = yes
	}
	else = {
		hidden_effect = {
		random_list = {
			
		50 = {
			add_to_variable = {IBR_native_alignment = -1}
			clamp_variable = {
				var = IBR_native_alignment
				min = -10
				max = 10
			}
			custom_effect_tooltip = IBR_worsen_franco_natives_tt
			IBR_check_caudillo_popularity = yes	
		}
				
		50 = {
			add_to_variable = {IBR_native_alignment = 1}
			clamp_variable = {
				var = IBR_native_alignment
				min = -10
				max = 10
			}
			custom_effect_tooltip = IBR_worsen_salazar_natives_tt
			IBR_check_caudillo_popularity = yes	
		}
		}
		}
	}
}
IBR_worsen_foreign_opinion = { 
	if = { 
		limit = { 
			has_country_leader = {
				name = "Francisco Franco"
			}
		}
		add_to_variable = {IBR_foreign_alignment = -1.5}
		clamp_variable = {
			var = IBR_foreign_alignment
			min = -15
			max = 15
		}
		custom_effect_tooltip = IBR_worsen_franco_foreign_tt
		IBR_check_caudillo_popularity = yes
	}
	else_if = { 
		limit = { 
			OR = { 
				has_country_flag = cau_weak_salazar
				has_country_flag = cau_strong_salazar
			}
		}
		add_to_variable = {IBR_foreign_alignment = 1.5}
		clamp_variable = {
			var = IBR_foreign_alignment
			min = -15
			max = 15
		}
		custom_effect_tooltip = IBR_worsen_salazar_foreign_tt
		IBR_check_caudillo_popularity = yes
	}
	else = {
		hidden_effect = {
		random_list = {
			
		50 = {
			add_to_variable = {IBR_foreign_alignment = -1.5}
			clamp_variable = {
				var = IBR_foreign_alignment
				min = -15
				max = 15
			}
			custom_effect_tooltip = IBR_worsen_franco_foreign_tt
			IBR_check_caudillo_popularity = yes	
		}
				
		50 = {
			add_to_variable = {IBR_foreign_alignment = 1.5}
			clamp_variable = {
				var = IBR_foreign_alignment
				min = -15
				max = 15
			}
			custom_effect_tooltip = IBR_worsen_salazar_foreign_tt
			IBR_check_caudillo_popularity = yes	
		}
		}
		}
	}
}
IBR_worsen_intellectual_opinion = { 
	if = { 
		limit = { 
			has_country_leader = {
				name = "Francisco Franco"
			}
		}
		add_to_variable = {IBR_intellectual_alignment = -1.5}
		clamp_variable = {
			var = IBR_intellectual_alignment
			min = -15
			max = 15
		}
		custom_effect_tooltip = IBR_worsen_franco_intellectuals_tt
		IBR_check_caudillo_popularity = yes
	}
	else_if = { 
		limit = { 
			OR = { 
				has_country_flag = cau_weak_salazar
				has_country_flag = cau_strong_salazar
			}
		}
		add_to_variable = {IBR_intellectual_alignment = 1.5}
		clamp_variable = {
			var = IBR_intellectual_alignment
			min = -15
			max = 15
		}
		custom_effect_tooltip = IBR_worsen_salazar_intellectuals_tt
		IBR_check_caudillo_popularity = yes
	}
	else = {
		hidden_effect = {
		random_list = {
			
		50 = {
			add_to_variable = {IBR_intellectual_alignment = -1.5}
			clamp_variable = {
				var = IBR_intellectual_alignment
				min = -15
				max = 15
			}
			custom_effect_tooltip = IBR_worsen_franco_intellectuals_tt
			IBR_check_caudillo_popularity = yes	
		}
				
		50 = {
			add_to_variable = {IBR_intellectual_alignment = 1.5}
			clamp_variable = {
				var = IBR_intellectual_alignment
				min = -15
				max = 15
			}
			custom_effect_tooltip = IBR_worsen_salazar_intellectuals_tt
			IBR_check_caudillo_popularity = yes	
		}
		}
		}
	}
}
IBR_worsen_majority_opinion = { 
	if = { 
		limit = { 
			has_country_leader = {
				name = "Francisco Franco"
			}
		}
		add_to_variable = {IBR_majority_alignment = -1}
		clamp_variable = {
			var = IBR_majority_alignment
			min = -10
			max = 10
		}
		custom_effect_tooltip = IBR_worsen_franco_majority_tt
		IBR_check_caudillo_popularity = yes
	}
	else_if = { 
		limit = { 
			OR = { 
				has_country_flag = cau_weak_salazar
				has_country_flag = cau_strong_salazar
			}
		}
		add_to_variable = {IBR_majority_alignment = 1}
		clamp_variable = {
			var = IBR_majority_alignment
			min = -10
			max = 10
		}
		custom_effect_tooltip = IBR_worsen_salazar_majority_tt
		IBR_check_caudillo_popularity = yes
	}
	else = {
		hidden_effect = {
		random_list = {
			
		50 = {
			add_to_variable = {IBR_majority_alignment = -1}
			clamp_variable = {
				var = IBR_majority_alignment
				min = -10
				max = 10
			}
			custom_effect_tooltip = IBR_worsen_franco_majority_tt
			IBR_check_caudillo_popularity = yes	
		}
				
		50 = {
			add_to_variable = {IBR_majority_alignment = 1}
			clamp_variable = {
				var = IBR_majority_alignment
				min = -10
				max = 10
			}
			custom_effect_tooltip = IBR_worsen_salazar_majority_tt
			IBR_check_caudillo_popularity = yes	
		}
		}
		}
	}
}
IBR_worsen_regional_opinion = { 
	if = { 
		limit = { 
			has_country_leader = {
				name = "Francisco Franco"
			}
		}
		add_to_variable = {IBR_regional_alignment = -1}
		clamp_variable = {
			var = IBR_regional_alignment
			min = -10
			max = 10
		}
		custom_effect_tooltip = IBR_worsen_franco_regional_tt
		IBR_check_caudillo_popularity = yes
	}
	else_if = { 
		limit = { 
			OR = { 
				has_country_flag = cau_weak_salazar
				has_country_flag = cau_strong_salazar
			}
		}
		add_to_variable = {IBR_regional_alignment = 1}
		clamp_variable = {
			var = IBR_regional_alignment
			min = -10
			max = 10
		}
		custom_effect_tooltip = IBR_worsen_salazar_regional_tt
		IBR_check_caudillo_popularity = yes
	}
	else = {
		hidden_effect = {
		random_list = {
			
		50 = {
			add_to_variable = {IBR_regional_alignment = -1}
			clamp_variable = {
				var = IBR_regional_alignment
				min = -10
				max = 10
			}
			custom_effect_tooltip = IBR_worsen_franco_regional_tt
			IBR_check_caudillo_popularity = yes	
		}
				
		50 = {
			add_to_variable = {IBR_regional_alignment = 1}
			clamp_variable = {
				var = IBR_regional_alignment
				min = -10
				max = 10
			}
			custom_effect_tooltip = IBR_worsen_salazar_regional_tt
			IBR_check_caudillo_popularity = yes	
		}
		}
		}
	}
}

IBR_council_clamp = {
	if = {
		limit = { has_country_flag = advisory_council }
		
		clamp_variable = {
			var = IBR_council_influence
			min = 0
			max = 100
		}
		
	}
	else = {
		clamp_variable = {
			var = IBR_council_reformism
			min = 0
			max = 100
		}
	}
}

IBR_abandon_dam = { 
	every_country = {
		news_event = { 
			id = WORLD.463
			days = 1
		}
	}
	remove_ideas = The_Gibraltar_Dam
	add_ideas = IBR_The_Gibraltar_Dam_Abandoned
	set_country_flag = IBR_abandoned_dam_flag
	if = { 
		limit = { 
			has_country_flag = IBR_manuel_elices_dam
		}
		clr_country_flag = IBR_manuel_elices_dam 
		set_country_flag = IBR_government_dam
	}
	if = { 
		limit = { 
			has_country_flag = IBR_leopoldo_sotelo_dam
		}
		clr_country_flag = IBR_leopoldo_sotelo_dam 
		set_country_flag = IBR_government_dam
	}
	if = { 
		limit = { 
			has_country_flag = IBR_rui_sanches_dam
		}
		clr_country_flag = IBR_rui_sanches_dam 
		set_country_flag = IBR_government_dam
	}
	subtract_from_variable = { IBR_dam_cost = IBR_dam_cost_upgrades }
	subtract_from_variable = { IBR_dam_cost_upgrades = IBR_dam_cost_upgrades }
	set_temp_variable = { IBR_dam_maintenance_temp = IBR_dam_cost_maintenance }
	divide_temp_variable = {IBR_dam_maintenance_temp = 2 }
	set_variable = { IBR_cost_dam_1 = IBR_dam_maintenance_temp }
	subtract_from_variable = { IBR_dam_cost_maintenance = IBR_cost_dam_1 }
	subtract_from_variable = { IBR_dam_cost = IBR_cost_dam_1 }
	set_temp_variable = { IBR_dam_worker_temp = IBR_dam_cost_workers }
	divide_temp_variable = {IBR_dam_worker_temp = 2 }
	set_variable = { IBR_cost_dam_2 = IBR_dam_worker_temp }
	subtract_from_variable = { IBR_dam_cost_workers = IBR_cost_dam_2 }
	subtract_from_variable = { IBR_dam_cost = IBR_cost_dam_2 }
	subtract_from_variable = { IBR_dam_workers = 2 }
}
IBR_add_1_dam_budget = { 
	if = { 
		limit = { 
			IBR = {
				check_variable = {
					var = money_reserves
					value = 1
					compare = greater_than_or_equals
				}
			}
		}
		IBR = {
			add_to_variable = {IBR_dam_budget = 1 }
			add_to_variable = {national_debt = -1 }
		}
	}
	else = { 
		IBR = {
			add_to_variable = {national_debt = 1 }
			add_to_variable = {IBR_dam_budget = 1 }
		}
	}
}
IBR_add_2_dam_budget = { 
	if = { 
		limit = { 
			IBR = {
				check_variable = {
					var = money_reserves
					value = 2
					compare = greater_than_or_equals
				}
			}
		}
		IBR = {
			add_to_variable = {IBR_dam_budget = 2 }
			add_to_variable = {national_debt = -2 }
		}
	}
	else = { 
		IBR = {
			add_to_variable = {national_debt = 2 }
			add_to_variable = {IBR_dam_budget = 2 }
		}
	}
}
IBR_add_3_dam_budget = { 
	if = { 
		limit = { 
			IBR = {
				check_variable = {
					var = money_reserves
					value = 3
					compare = greater_than_or_equals
				}
			}
		}
		IBR = {
			add_to_variable = {IBR_dam_budget = 3 }
			add_to_variable = {national_debt = -3 }
		}
	}
	else = { 
		IBR = {
			add_to_variable = {national_debt = 3 }
			add_to_variable = {IBR_dam_budget = 3 }
		}
	}
}
IBR_add_5_dam_budget = { 
	if = { 
		limit = { 
			IBR = {
				check_variable = {
					var = money_reserves
					value = 5
					compare = greater_than_or_equals
				}
			}
		}
		IBR = {
			add_to_variable = {IBR_dam_budget = 5 }
		}
	}
	else = { 
		IBR = {
			add_to_variable = {national_debt = 5 }
			add_to_variable = {IBR_dam_budget = 5 }
		}
	}
}
IBR_add_10_dam_budget = { 
	if = { 
		limit = { 
			IBR = {
				check_variable = {
					var = money_reserves
					value = 10
					compare = greater_than_or_equals
				}
			}
		}
		IBR = {
			add_to_variable = {IBR_dam_budget = 10 }
		}
	}
	else = { 
		IBR = {
			add_to_variable = {national_debt = 10 }
			add_to_variable = {IBR_dam_budget = 10 }
		}
	}
}
IBR_update_caudillo_progress_bar = {
	set_temp_variable = { caudillo_temp_bar_variable = 0 } 
	add_to_temp_variable = {caudillo_temp_bar_variable = IBR_military_alignment} 
	add_to_temp_variable = {caudillo_temp_bar_variable = IBR_church_alignment} 
	add_to_temp_variable = {caudillo_temp_bar_variable = IBR_burocrat_alignment} 
	add_to_temp_variable = {caudillo_temp_bar_variable = IBR_business_alignment} 
	add_to_temp_variable = {caudillo_temp_bar_variable = IBR_settlers_alignment} 
	add_to_temp_variable = {caudillo_temp_bar_variable = IBR_native_alignment} 
	add_to_temp_variable = {caudillo_temp_bar_variable = IBR_foreign_alignment} 
	add_to_temp_variable = {caudillo_temp_bar_variable = IBR_intellectual_alignment} 
	add_to_temp_variable = {caudillo_temp_bar_variable = IBR_majority_alignment} 
	add_to_temp_variable = {caudillo_temp_bar_variable = IBR_regional_alignment} 
	if = { 
		limit = { 
			check_variable = {caudillo_temp_bar_variable = 0 }
		}
		set_variable = {IBR_caudillo_popularity_bar = 50}
	}
	if = { 
		limit = { 
			check_variable = {caudillo_temp_bar_variable > 0 }
		}
		add_to_temp_variable = {caudillo_temp_bar_variable = 50}
		clamp_temp_variable = {
			var = caudillo_temp_bar_variable
			min = 50
			max = 100
		}
		set_variable = {IBR_caudillo_popularity_bar = caudillo_temp_bar_variable}
	}
	if = { 
		limit = { 
			check_variable = {caudillo_temp_bar_variable < 0 }
		}
		add_to_temp_variable = {caudillo_temp_bar_variable = 50}
		clamp_temp_variable = {
			var = caudillo_temp_bar_variable
			min = 0
			max = 50
		}
		set_variable = {IBR_caudillo_popularity_bar = caudillo_temp_bar_variable}
	}
}

IBR_build_mil_inf_random = {
	random_owned_controlled_state = {
		limit = {
			free_building_slots = {
				building = arms_factory
				size > 0
				include_locked = yes
			}
			OR = {
				is_in_home_area = yes
				NOT = {
					owner = {
						any_owned_state = {
							free_building_slots = {
								building = arms_factory
								size > 0
								include_locked = yes
							}
							is_in_home_area = yes
						}
					}
				}
			}
		}
		add_extra_state_shared_building_slots = 1
		add_building_construction = {
			type = arms_factory
			level = 1
			instant_build = yes
		}
	}
	random_owned_controlled_state = {
		limit = {
			infrastructure < 10
			OR = {
				is_in_home_area = yes
				NOT = {
					owner = {
						any_owned_state = {
							infrastructure < 10	
							is_in_home_area = yes
						}
					}
				}
			}		
		}
		add_building_construction = {
			type = infrastructure
			level = 1
			instant_build = yes
		}
	}
}

IBR_build_mil_random = {
	random_owned_controlled_state = {
		limit = {
			free_building_slots = {
				building = arms_factory
				size > 0
				include_locked = yes
			}
			OR = {
				is_in_home_area = yes
				NOT = {
					owner = {
						any_owned_state = {
							free_building_slots = {
								building = arms_factory
								size > 0
								include_locked = yes
							}
							is_in_home_area = yes
						}
					}
				}
			}
		}
		add_extra_state_shared_building_slots = 1
		add_building_construction = {
			type = arms_factory
			level = 1
			instant_build = yes
		}
	}
}
#lisbon flood
IBR_lisbon_coverup_check = {
	set_temp_variable = { IBR_lisbonflood_reliefx5 = IBR_lisbonflood_relief }
	multiply_temp_variable = { IBR_lisbonflood_reliefx5 = 5 }
	set_temp_variable = { IBR_lisbonflood_coverup = IBR_lisbonflood_censor }
	divide_temp_variable = { IBR_lisbonflood_coverup = IBR_lisbonflood_reliefx5 }
	set_temp_variable = { IBR_lisbonflood_1 = 1 }
	
	subtract_from_temp_variable = { IBR_lisbonflood_1 = IBR_lisbonflood_coverup }
	
	hidden_effect = {
	
	random_list = {
		IBR_lisbonflood_coverup = {
			hidden_effect = {
				country_event = {
					id = IBR.30159
					days = 7
				}
			}
		}
		IBR_lisbonflood_1 = {
			
			if = {
				limit = { 
					check_variable = { IBR_lisbonflood_support < 4 }
					check_variable = { IBR_lisbonflood_censor < 3 }
				}
				hidden_effect = {
					country_event = {
						id = IBR.30160
						days = 8
					}
				}
			}
			else = {
				
				if = {
					limit = { 
						check_variable = { IBR_lisbonflood_relief < 4 }
					}
					hidden_effect = {
						country_event = {
							id = IBR.30163
							days = 18
						}
					}
				}
				else_if = {
					limit = { 
						check_variable = { IBR_lisbonflood_relief < 7 }
					}
					hidden_effect = {
						country_event = {
							id = IBR.30162
							days = 18
						}
					}
				}
				else = {
					hidden_effect = {
						country_event = {
							id = IBR.30161
							days = 18
						}
					}
				}
			}
		}
	}
	}
}
IBR_lisbon_disturbing_reports = {
	if = {
		limit = { 
			check_variable = { IBR_lisbonflood_support < 4 }
			check_variable = { IBR_lisbonflood_censor < 3 }
		}
		hidden_effect = {
			country_event = {
				id = IBR.30160
				days = 1
			}
		}
	}
	else = {
		
		if = {
			limit = { 
				check_variable = { IBR_lisbonflood_relief < 4 }
			}
			hidden_effect = {
				country_event = {
					id = IBR.30163
					days = 11
				}
			}
		}
		else_if = {
			limit = { 
				check_variable = { IBR_lisbonflood_relief < 7 }
			}
			hidden_effect = {
				country_event = {
					id = IBR.30162
					days = 11
				}
			}
		}
		else = {
			hidden_effect = {
				country_event = {
					id = IBR.30161
					days = 11
				}
			}
		}
	}
}

IBR_lisbon_under_arch = {
	if = {
		limit = { 
			check_variable = { IBR_lisbonflood_relief < 4 }
		}
		hidden_effect = {
			country_event = {
				id = IBR.30163
				days = 11
			}
		}
	}
	else_if = {
		limit = { 
			check_variable = { IBR_lisbonflood_relief < 7 }
		}
		hidden_effect = {
			country_event = {
				id = IBR.30162
				days = 11
			}
		}
	}
	else = {
		hidden_effect = {
			country_event = {
				id = IBR.30161
				days = 11
			}
		}
	}
}
IBR_lisbon_loss_calc = {
	set_temp_variable = { IBR_losscalc_1000 = 1000 }
	divide_temp_variable = { IBR_losscalc_1000 = IBR_lisbonflood_relief }
	add_to_variable = { IBR_lisbonflood_loss = IBR_losscalc_1000 }
	round_variable = IBR_lisbonflood_loss
}

IBR_lisbon_anger_calc = {
	
	set_variable = { IBR_lisbonflood_anger = IBR_lisbonflood_support }
	subtract_from_variable = { IBR_lisbonflood_anger = 8 }
	
	set_temp_variable = { IBR_lisbonflood_C = IBR_lisbonflood_censor }
	add_to_temp_variable = { IBR_lisbonflood_C = 1 }
	divide_temp_variable = { IBR_lisbonflood_C = 2 }
	
	divide_variable = { IBR_lisbonflood_anger = IBR_lisbonflood_C }
	
	#new part that makes anger proportional to loss
	
	set_temp_variable = { IBR_lisbon_proploss = IBR_lisbonflood_loss }
	divide_temp_variable = { IBR_lisbon_proploss = 1000 }
	multiply_variable = { IBR_lisbonflood_anger = IBR_lisbon_proploss }
	
	#SOME WEIRD SHIT HAPPENED WHERE THIS NUMBER IS NEGATIVE FOR SOME REASON AND INSTEAD OF JUST EASILY CHANGING IT HERE THINGS GOT A BIT FUCKED UP LATER ON OK?
}

IBR_lisbon_final_effects = {
	
	##Manpower
	
	set_temp_variable = { IBR_lisbon_manpower = IBR_lisbonflood_loss }
	multiply_temp_variable = { IBR_lisbon_manpower = -0.25 }
	round_temp_variable = IBR_lisbon_manpower
	
	add_manpower = IBR_lisbon_manpower
	
	##Council variables!!!
	
	if = { 
		limit = { 
			has_country_flag = legislature_council
			check_variable = { IBR_lisbonflood_anger < -2.9 }
		}
		set_temp_variable = { IBR_lisbon_reformism = IBR_lisbonflood_anger }
		multiply_temp_variable = { IBR_lisbon_reformism = -0.3 }
		
		add_to_variable = {IBR_council_reformism = IBR_lisbon_reformism }
		custom_effect_tooltip = IBR_reformist_tt_lisbonflood
	}
	if = { 
		limit = { 
			has_country_flag = advisory_council
			check_variable = { IBR_lisbonflood_anger < -2.9 }
		}
		set_temp_variable = { IBR_lisbon_influence = IBR_lisbonflood_anger }
		multiply_temp_variable = { IBR_lisbon_influence = -0.3 }
		
		add_to_variable = {IBR_council_influence = IBR_lisbon_influence }
		custom_effect_tooltip = IBR_influence_tt_lisbonflood
	}
	IBR_council_clamp = yes
	
	##IBRStab
	
	set_temp_variable = { IBR_lisbon_ibrstab = IBR_lisbonflood_anger }
	multiply_temp_variable = { IBR_lisbon_ibrstab = 0.25 } #was minus here
	
	add_to_variable = {
		var = IBRIberiaStability
		value = IBR_lisbon_ibrstab
	}
	multiply_temp_variable = { IBR_lisbon_ibrstab = -1 } #this is cause im lazy and dont want to redo the check_variables i did under like an idiot	
	if = { 
		limit = { 
			check_variable = { IBR_lisbon_ibrstab > 0 }
			check_variable = { IBR_lisbon_ibrstab < 2 }
		}	
		custom_effect_tooltip = IBR_sub_stability_small_tt
	}
	else_if = { 
		limit = { 
			check_variable = { IBR_lisbon_ibrstab > 1.99 }
			check_variable = { IBR_lisbon_ibrstab < 4 }
		}	
		custom_effect_tooltip = IBR_sub_stability_big_tt
	}
	else_if = { 
		limit = { 
			check_variable = { IBR_lisbon_ibrstab > 3.99 }
		}	
		custom_effect_tooltip = IBR_sub_stability_really_big_tt
	}
	
	##FSLP Variables
	
	#FSLP Support
	set_temp_variable = { IBR_lisbon_FSLPsupport = IBR_lisbonflood_anger }
	multiply_temp_variable = { IBR_lisbon_FSLPsupport = -0.3 }
	
	add_to_variable = {
		var = IBR_FSLP_Support
		value = IBR_lisbon_FSLPsupport
	}	
	if = { 
		limit = { 
			check_variable = { IBR_lisbon_FSLPsupport > 0 }
			check_variable = { IBR_lisbon_FSLPsupport < 2 }
		}	
		custom_effect_tooltip = IBR_add_fslp_support_small_tt
	}
	else_if = { 
		limit = { 
			check_variable = { IBR_lisbon_FSLPsupport > 1.99 }
			check_variable = { IBR_lisbon_FSLPsupport < 3 }
		}	
		custom_effect_tooltip = IBR_add_fslp_support_mid_tt
	}
	else_if = { 
		limit = { 
			check_variable = { IBR_lisbon_FSLPsupport > 2.99 }
		}	
		custom_effect_tooltip = IBR_add_fslp_support_big_tt
	}
	
	#FSLP Activity
	set_temp_variable = { IBR_lisbon_FSLPactivity = IBR_lisbonflood_anger }
	multiply_temp_variable = { IBR_lisbon_FSLPactivity = -0.2 }
	
	add_to_variable = {
		var = IBR_FSLP_Activity
		value = IBR_lisbon_FSLPactivity
	}
	if = { 
		limit = { 
			check_variable = { IBR_lisbon_FSLPactivity > 0 }
			check_variable = { IBR_lisbon_FSLPactivity < 2 }
		}	
		custom_effect_tooltip = IBR_add_fslp_activity_small_tt
	}
	else_if = { 
		limit = { 
			check_variable = { IBR_lisbon_FSLPactivity > 1.99 }
			check_variable = { IBR_lisbon_FSLPactivity < 3 }
		}	
		custom_effect_tooltip = IBR_add_fslp_activity_mid_tt
	}
	else_if = { 
		limit = { 
			check_variable = { IBR_lisbon_FSLPactivity > 2.99 }
		}	
		custom_effect_tooltip = IBR_add_fslp_activity_big_tt
	}
	#vulnerable check is in the main event don't worry!
	
	##GDP (Tbh i'll lay off gdp for this.. i feel it already has enough effects to be honest)
}

IBR_lisbon_clearall = {
	clear_variable = IBR_lisbonflood_relief
	clear_variable = IBR_lisbonflood_censor
	clear_variable = IBR_lisbonflood_support
	clear_variable = IBR_lisbonflood_loss
	clear_variable = IBR_lisbonflood_anger
}